<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 14 Dehydration Recovery | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
<meta name="author" content="Thomas E. Love">
<meta name="description" content="The hydrate data describe the degree of recovery that takes place 90 minutes following treatment of moderate to severe dehydration, for 36 children diagnosed at a hospital’s main pediatric clinic....">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 14 Dehydration Recovery | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta property="og:type" content="book">
<meta property="og:url" content="https://thomaselove.github.io/431-notes/Hydrate-Study.html">
<meta property="og:description" content="The hydrate data describe the degree of recovery that takes place 90 minutes following treatment of moderate to severe dehydration, for 36 children diagnosed at a hospital’s main pediatric clinic....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 14 Dehydration Recovery | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta name="twitter:description" content="The hydrate data describe the degree of recovery that takes place 90 minutes following treatment of moderate to severe dehydration, for 36 children diagnosed at a hospital’s main pediatric clinic....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Working with These Notes</a></li>
<li><a class="" href="data-science.html"><span class="header-section-number">1</span> Data Science</a></li>
<li class="book-part">Part A. Exploring Data</li>
<li><a class="" href="the-palmer-penguins.html"><span class="header-section-number">2</span> The Palmer Penguins</a></li>
<li><a class="" href="nhanes1.html"><span class="header-section-number">3</span> NHANES: A First Look</a></li>
<li><a class="" href="data-structures-variable-types-sampling-nhanes.html"><span class="header-section-number">4</span> Data Structures, Variable Types &amp; Sampling NHANES</a></li>
<li><a class="" href="visualizing-nhanes-data.html"><span class="header-section-number">5</span> Visualizing NHANES Data</a></li>
<li><a class="" href="summarizing_quantities.html"><span class="header-section-number">6</span> Summarizing Quantities</a></li>
<li><a class="" href="summarizing-categories.html"><span class="header-section-number">7</span> Summarizing Categories</a></li>
<li><a class="" href="miss.html"><span class="header-section-number">8</span> Missing Data and Single Imputation</a></li>
<li><a class="" href="NYFS-Study.html"><span class="header-section-number">9</span> National Youth Fitness Survey</a></li>
<li><a class="" href="assessing-normality.html"><span class="header-section-number">10</span> Assessing Normality</a></li>
<li><a class="" href="straight-line-models.html"><span class="header-section-number">11</span> Straight Line Models</a></li>
<li><a class="" href="linearizing-transformations.html"><span class="header-section-number">12</span> Linearizing Transformations</a></li>
<li><a class="" href="studying-crab-claws-crabs.html"><span class="header-section-number">13</span> Studying Crab Claws (crabs)</a></li>
<li><a class="active" href="Hydrate-Study.html"><span class="header-section-number">14</span> Dehydration Recovery</a></li>
<li><a class="" href="WCGS-Study.html"><span class="header-section-number">15</span> The WCGS</a></li>
<li class="book-part">Part B. Comparing Summaries</li>
<li><a class="" href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></li>
<li><a class="" href="the-ibuprofen-in-sepsis-randomized-clinical-trial.html"><span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial</a></li>
<li><a class="" href="comparing-means-with-paired-samples.html"><span class="header-section-number">18</span> Comparing Means with Paired Samples</a></li>
<li><a class="" href="hypothesis-testing-what-is-it-good-for.html"><span class="header-section-number">19</span> Hypothesis Testing: What is it good for?</a></li>
<li><a class="" href="two-examples-comparing-means.html"><span class="header-section-number">20</span> Two Examples Comparing Means</a></li>
<li><a class="" href="estimating-a-population-proportion.html"><span class="header-section-number">21</span> Estimating a Population Proportion</a></li>
<li><a class="" href="comparing-proportions-with-two-independent-samples.html"><span class="header-section-number">22</span> Comparing Proportions with Two Independent Samples</a></li>
<li><a class="" href="power-and-proportions.html"><span class="header-section-number">23</span> Power and Proportions</a></li>
<li><a class="" href="larger-contingency-tables.html"><span class="header-section-number">24</span> Larger Contingency Tables</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">25</span> Analysis of Variance</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="some-r-tips.html">Some R Tips</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/THOMASELOVE/431-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="Hydrate-Study" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Dehydration Recovery<a class="anchor" aria-label="anchor" href="#Hydrate-Study"><i class="fas fa-link"></i></a>
</h1>
<p>The <code>hydrate</code> data describe the degree of recovery that takes place 90 minutes following treatment of moderate to severe dehydration, for 36 children diagnosed at a hospital’s main pediatric clinic.</p>
<p>Upon diagnosis and study entry, patients were treated with an electrolytic solution at one of seven <code>dose</code> levels (0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0 mEq/l) in a frozen, flavored, ice popsicle. The degree of rehydration was determined using a subjective scale based on physical examination and parental input, converted to a 0 to 100 point scale, representing the percent of recovery (<code>recov.score</code>). Each child’s <code>age</code> (in years) and <code>weight</code> (in pounds) are also available.</p>
<p>First, we’ll check ranges (and for missing data) in the <code>hydrate</code> file.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hydrate</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/hydrate.csv"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hydrate</span><span class="op">)</span></code></pre></div>
<pre><code>       id         recov.score          dose      
 Min.   : 1.00   Min.   : 44.00   Min.   :0.000  
 1st Qu.: 9.75   1st Qu.: 61.50   1st Qu.:1.000  
 Median :18.50   Median : 71.50   Median :1.500  
 Mean   :18.50   Mean   : 71.56   Mean   :1.569  
 3rd Qu.:27.25   3rd Qu.: 80.00   3rd Qu.:2.500  
 Max.   :36.00   Max.   :100.00   Max.   :3.000  
      age             weight     
 Min.   : 3.000   Min.   :22.00  
 1st Qu.: 5.000   1st Qu.:34.50  
 Median : 6.500   Median :47.50  
 Mean   : 6.667   Mean   :46.89  
 3rd Qu.: 8.000   3rd Qu.:57.25  
 Max.   :11.000   Max.   :76.00  </code></pre>
<p>There are no missing values, and all of the ranges make sense. There are no especially egregious problems to report.</p>
<div id="a-scatterplot-matrix" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> A Scatterplot Matrix<a class="anchor" aria-label="anchor" href="#a-scatterplot-matrix"><i class="fas fa-link"></i></a>
</h2>
<p>Next, we’ll use a scatterplot matrix to summarize relationships between the outcome <code>recov.score</code> and the key predictor <code>dose</code> as well as the ancillary predictors <code>age</code> and <code>weight</code>, which are of less interest, but are expected to be related to our outcome. The one below uses the <code>ggpairs</code> function in the <code>GGally</code> package, as introduced in Part A of the Notes. We place the outcome in the bottom row, and the key predictor immediately above it, with <code>age</code> and <code>weight</code> in the top rows, using the <code>select</code> function within the `<code>ggpairs</code> call.</p>
<div class="sourceCode" id="cb500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">hydrate</span>, <span class="va">age</span>, <span class="va">weight</span>, <span class="va">dose</span>, <span class="va">recov.score</span><span class="op">)</span>, 
                title <span class="op">=</span> <span class="st">"Scatterplot Matrix for hydrate data"</span><span class="op">)</span></code></pre></div>
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk10-1.png" width="672"></div>
<p>What can we conclude here?</p>
<ul>
<li>It looks like <code>recov.score</code> has a moderately strong negative relationship with both <code>age</code> and <code>weight</code> (with correlations in each case around -0.5), but a positive relationship with <code>dose</code> (correlation = 0.36).</li>
<li>The distribution of <code>recov.score</code> looks to be pretty close to Normal. No potential predictors (<code>age</code>, <code>weight</code> and <code>dose</code>) show substantial non-Normality.</li>
<li>
<code>age</code> and <code>weight</code>, as we’d expect, show a very strong and positive linear relationship, with <em>r</em> = 0.94</li>
<li>Neither <code>age</code> nor <code>weight</code> shows a meaningful relationship with <code>dose</code>. (<em>r</em> = 0.16)</li>
</ul>
</div>
<div id="are-the-recovery-scores-well-described-by-a-normal-model" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Are the recovery scores well described by a Normal model?<a class="anchor" aria-label="anchor" href="#are-the-recovery-scores-well-described-by-a-normal-model"><i class="fas fa-link"></i></a>
</h2>
<p>Next, we’ll do a more thorough graphical summary of our outcome, recovery score.</p>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hydrate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">recov.score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">'#440154'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Normal Q-Q plot: hydrate"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hydrate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recov.score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, 
                 bins <span class="op">=</span> <span class="fl">10</span>, fill <span class="op">=</span> <span class="st">'#440154'</span>, col <span class="op">=</span> <span class="st">'#FDE725'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, 
                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">mean</a></span><span class="op">(</span><span class="va">hydrate</span><span class="op">$</span><span class="va">recov.score</span><span class="op">)</span>, 
                            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">sd</a></span><span class="op">(</span><span class="va">hydrate</span><span class="op">$</span><span class="va">recov.score</span><span class="op">)</span><span class="op">)</span>,
                col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Density Function: hydrate"</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hydrate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recov.score</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">'#440154'</span>, outlier.color <span class="op">=</span> <span class="st">'#440154'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot: hydrate"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="op">(</span><span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk20-1.png" width="672"></div>
<div class="sourceCode" id="cb503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="op">~</span> <span class="va">recov.score</span>, data <span class="op">=</span> <span class="va">hydrate</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">min</th>
<th align="right">Q1</th>
<th align="right">median</th>
<th align="right">Q3</th>
<th align="right">max</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">n</th>
<th align="right">missing</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left"></td>
<td align="right">44</td>
<td align="right">61.5</td>
<td align="right">71.5</td>
<td align="right">80</td>
<td align="right">100</td>
<td align="right">71.6</td>
<td align="right">12.9</td>
<td align="right">36</td>
<td align="right">0</td>
</tr></tbody>
</table></div>
<p>I see no serious problems with assuming Normality for these recovery scores. Our outcome variable doesn’t in any way <em>need</em> to follow a Normal distribution, but it’s nice when it does, because summaries involving means and standard deviations make sense.</p>
</div>
<div id="simple-regression-using-dose-to-predict-recovery" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Simple Regression: Using Dose to predict Recovery<a class="anchor" aria-label="anchor" href="#simple-regression-using-dose-to-predict-recovery"><i class="fas fa-link"></i></a>
</h2>
<p>To start, consider a simple (one predictor) regression model using <code>dose</code> alone to predict the % Recovery (<code>recov.score</code>). Ignoring the <code>age</code> and <code>weight</code> covariates, what can we conclude about this relationship?</p>
</div>
<div id="the-scatterplot-with-fitted-linear-model" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> The Scatterplot, with fitted Linear Model<a class="anchor" aria-label="anchor" href="#the-scatterplot-with-fitted-linear-model"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hydrate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>, y <span class="op">=</span> <span class="va">recov.score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simple Regression model for the hydrate data"</span>,
         x <span class="op">=</span> <span class="st">"Dose (mEq/l)"</span>, y <span class="op">=</span> <span class="st">"Recovery Score (points)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk30-1.png" width="672"></div>
</div>
<div id="the-fitted-linear-model" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> The Fitted Linear Model<a class="anchor" aria-label="anchor" href="#the-fitted-linear-model"><i class="fas fa-link"></i></a>
</h2>
<p>To obtain the fitted linear regression model, we use the <code>lm</code> function:</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recov.score</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">hydrate</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">63.90</td>
<td align="right">3.97</td>
<td align="right">16.09</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">dose</td>
<td align="right">4.88</td>
<td align="right">2.17</td>
<td align="right">2.25</td>
<td align="right">0.03</td>
</tr>
</tbody>
</table></div>
<p>So, our fitted regression model (prediction model) is <code>recov.score</code> = 63.9 + 4.88 <code>dose</code>.</p>
<div id="confidence-intervals" class="section level3" number="14.5.1">
<h3>
<span class="header-section-number">14.5.1</span> Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"><i class="fas fa-link"></i></a>
</h3>
<p>We can obtain confidence intervals around the coefficients of our fitted model with <code>tidy</code>, too.</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">m1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">63.90</td>
<td align="right">3.97</td>
<td align="right">16.09</td>
<td align="right">0.00</td>
<td align="right">57.18</td>
<td align="right">70.61</td>
</tr>
<tr class="even">
<td align="left">dose</td>
<td align="right">4.88</td>
<td align="right">2.17</td>
<td align="right">2.25</td>
<td align="right">0.03</td>
<td align="right">1.21</td>
<td align="right">8.55</td>
</tr>
</tbody>
</table></div>
<p>So, our 90% confidence interval for the slope of <code>dose</code> ranges from 1.21 to 8.55.</p>
</div>
</div>
<div id="coefficient-plots" class="section level2" number="14.6">
<h2>
<span class="header-section-number">14.6</span> Coefficient Plots<a class="anchor" aria-label="anchor" href="#coefficient-plots"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>tidy</code> method makes it easy to construct coefficient plots using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">m1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">td</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, y <span class="op">=</span> <span class="va">term</span>, col <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_crossbarh</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">conf.low</span>, xmax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Estimates with 90% confidence intervals from m1 in hydrate"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk60-1.png" width="672"></div>
<p>Another option would be to use <code>geom_errorbarh</code> in this setting, perhaps with a different color scheme…</p>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">m1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">td</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, y <span class="op">=</span> <span class="va">term</span>, col <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html">geom_errorbarh</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">conf.low</span>, xmax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Estimates with 90% confidence intervals from m1 in hydrate"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk70-1.png" width="672"></div>
</div>
<div id="the-summary-output" class="section level2" number="14.7">
<h2>
<span class="header-section-number">14.7</span> The Summary Output<a class="anchor" aria-label="anchor" href="#the-summary-output"><i class="fas fa-link"></i></a>
</h2>
<p>To get a more complete understanding of the fitted model, we’ll summarize it.</p>
<div class="sourceCode" id="cb509"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recov.score</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">hydrate</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = recov.score ~ dose, data = hydrate)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3360  -7.2763   0.0632   8.4233  23.9028 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   63.896      3.970  16.093   &lt;2e-16 ***
dose           4.881      2.172   2.247   0.0313 *  
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.21 on 34 degrees of freedom
Multiple R-squared:  0.1293,    Adjusted R-squared:  0.1037 
F-statistic: 5.047 on 1 and 34 DF,  p-value: 0.03127</code></pre>
<div id="model-specification" class="section level3" number="14.7.1">
<h3>
<span class="header-section-number">14.7.1</span> Model Specification<a class="anchor" aria-label="anchor" href="#model-specification"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>The first part of the output specifies the model that has been fit.
<ul>
<li>Here, we have a simple regression model that predicts <code>recov.score</code> on the basis of <code>dose</code>.</li>
<li>Notice that we’re treating <code>dose</code> here as a quantitative variable. If we wanted <code>dose</code> to be treated as a factor, we’d have specified that in the model.</li>
</ul>
</li>
</ol>
</div>
<div id="residual-summary" class="section level3" number="14.7.2">
<h3>
<span class="header-section-number">14.7.2</span> Residual Summary<a class="anchor" aria-label="anchor" href="#residual-summary"><i class="fas fa-link"></i></a>
</h3>
<ol start="2" style="list-style-type: decimal">
<li>The second part of the output summarizes the regression <strong>residuals</strong> across the subjects involved in fitting the model.
<ul>
<li>The <strong>residual</strong> is defined as the Actual value of our outcome minus the predicted value of that outcome fitted by the model.</li>
<li>In our case, the residual for a given child is their actual <code>recov.score</code> minus the predicted <code>recov.score</code> according to our model, for that child.</li>
<li>The residual summary gives us a sense of how “incorrect” our predictions are for the <code>hydrate</code> observations.
<ul>
<li>A positive residual means that the observed value was higher than the predicted value from the linear regression model, so the prediction was too low.</li>
<li>A negative residual means that the observed value was lower than the predicted value from the linear regression model, so the prediction was too high.</li>
<li>The residuals will center near 0 (the ordinary least squares model fitting process is designed so the mean of the residuals will always be zero)</li>
<li>We hope to see the median of the residuals also be near zero, generally. In this case, the median prediction is 0.06 point too low.</li>
<li>The minimum and maximum show us the largest prediction errors, made in the subjects used to fit this model.</li>
<li>Here, we predicted a recovery score that was 22.3 points too high for one patient, and another of our predicted recovery scores was 23.9 points too low.</li>
<li>The middle half of our predictions were between 8.4 points too low and 7.3 points too high.</li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<div id="coefficients-output" class="section level3" number="14.7.3">
<h3>
<span class="header-section-number">14.7.3</span> Coefficients Output<a class="anchor" aria-label="anchor" href="#coefficients-output"><i class="fas fa-link"></i></a>
</h3>
<ol start="3" style="list-style-type: decimal">
<li>The <strong>Coefficients</strong> output begins with a table of the estimated coefficients from the regression equation.
<ul>
<li>Generally, we write a simple regression model as <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span>.</li>
<li>In the <code>hydrate</code> model, we have <code>recov.score</code> = <span class="math inline">\(\beta_0\)</span> + <span class="math inline">\(\beta_1\)</span> <code>dose</code>.</li>
<li>The first column of the table gives the estimated <span class="math inline">\(\beta\)</span> coefficients for our model
<ul>
<li>Here the estimated intercept <span class="math inline">\(\hat{\beta_0} = 63.9\)</span>
</li>
<li>The estimated slope of dose <span class="math inline">\(\hat{\beta_1} = 4.88\)</span>
</li>
<li>Thus, our model is <code>recov.score</code>= 63.9 + 4.88 <code>dose</code>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>We interpret these coefficients as follows:</p>
<ul>
<li>The intercept (63.9) is the predicted <code>recov.score</code> for a patient receiving a <code>dose</code> of 0 mEq/l of the electrolytic solution.</li>
<li>The slope (4.88) of the <code>dose</code> is the predicted <em>change</em> in <code>recov.score</code> associated with a 1 mEq/l increase in the dose of electrolytic solution.
<ul>
<li>Essentially, if we have two children like the ones studied here, and we give Roger a popsicle with dose X and Sarah a popsicle with dose X + 1, then this model predicts that Sarah will have a recovery score that is 4.88 points higher than will Roger.</li>
<li>From the confidence interval output we saw previously with the function <code><a href="https://rdrr.io/pkg/mosaic/man/confint.html">confint(lm(recov.score ~ dose))</a></code>, we are 95% confident that the true slope for <code>dose</code> is between (0.47, 9.30) mEq/l. We are also 95% confident that the true intercept is between (55.8, 72.0).</li>
</ul>
</li>
</ul>
</div>
<div id="correlation-and-slope" class="section level3" number="14.7.4">
<h3>
<span class="header-section-number">14.7.4</span> Correlation and Slope<a class="anchor" aria-label="anchor" href="#correlation-and-slope"><i class="fas fa-link"></i></a>
</h3>
<p>If we like, we can use the <code>cor</code> function to specify the Pearson correlation of <code>recov.score</code> and <code>dose</code>, which turns out to be 0.36.
- Note that the <strong>slope</strong> in a simple regression model will follow the sign of the Pearson correlation coefficient, in this case, both will be positive.</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hydrate</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">cor</a></span><span class="op">(</span><span class="va">recov.score</span>, <span class="va">dose</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 0.359528</code></pre>
</div>
<div id="coefficient-testing" class="section level3" number="14.7.5">
<h3>
<span class="header-section-number">14.7.5</span> Coefficient Testing<a class="anchor" aria-label="anchor" href="#coefficient-testing"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recov.score</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">hydrate</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = recov.score ~ dose, data = hydrate)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3360  -7.2763   0.0632   8.4233  23.9028 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   63.896      3.970  16.093   &lt;2e-16 ***
dose           4.881      2.172   2.247   0.0313 *  
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.21 on 34 degrees of freedom
Multiple R-squared:  0.1293,    Adjusted R-squared:  0.1037 
F-statistic: 5.047 on 1 and 34 DF,  p-value: 0.03127</code></pre>
<p>Next to each coefficient in the summary regression table is its estimated standard error, followed by the coefficient’s t value (the coefficient value divided by the standard error), and the associated two-tailed <em>p</em> value for the test of:</p>
<ul>
<li>H0: This coefficient’s <span class="math inline">\(\beta\)</span> value = 0 vs. </li>
<li>HA: This coefficient’s <span class="math inline">\(\beta\)</span> value <span class="math inline">\(\neq\)</span> 0.</li>
</ul>
<p>For the slope coefficient, we can interpret this choice as:</p>
<ul>
<li>H0: This predictor adds no predictive value to the model vs. </li>
<li>HA: This predictor adds some predictive value to the model.</li>
</ul>
<p>In the <code>hydrate</code> simple regression model, by running either <code>tidy</code> with or just the <code>confint</code> function shown below, we can establish a confidence interval for each of the estimated regression coefficients.</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">m1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">63.90</td>
<td align="right">3.97</td>
<td align="right">16.09</td>
<td align="right">0.00</td>
<td align="right">55.83</td>
<td align="right">71.96</td>
</tr>
<tr class="even">
<td align="left">dose</td>
<td align="right">4.88</td>
<td align="right">2.17</td>
<td align="right">2.25</td>
<td align="right">0.03</td>
<td align="right">0.47</td>
<td align="right">9.30</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/confint.html">confint</a></span><span class="op">(</span><span class="va">m1</span>, level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></code></pre></div>
<pre><code>                2.5 %    97.5 %
(Intercept) 55.826922 71.964589
dose         0.465695  9.295466</code></pre>
<p>If the slope of dose was in fact zero, then this would mean that knowing the dose information would be of no additional value in predicting the outcome over just guessing the mean of <code>recov.score</code> for every subject.</p>
<p>So, since the confidence interval for the slope of dose does not include zero, it appears that there is at least some evidence that the model <code>m1</code> is more effective than a model that ignores the <code>dose</code> information (and simply predicts the mean of <code>recov.score</code> for each subject.) That’s not saying much, actually.</p>
</div>
<div id="summarizing-the-quality-of-fit" class="section level3" number="14.7.6">
<h3>
<span class="header-section-number">14.7.6</span> Summarizing the Quality of Fit<a class="anchor" aria-label="anchor" href="#summarizing-the-quality-of-fit"><i class="fas fa-link"></i></a>
</h3>
<ol start="4" style="list-style-type: decimal">
<li>The next part of the regression summary output is a summary of fit quality.</li>
</ol>
<p>The <strong>residual standard error</strong> estimates the standard deviation of the prediction errors made by the model.</p>
<ul>
<li>If assumptions hold, the model will produce residuals that follow a Normal distribution with mean 0 and standard deviation equal to this residual standard error.
<ul>
<li>So we’d expect roughly 95% of our residuals to fall between -2(12.21) and +2(12.21), or roughly -24.4 to +24.4 and that we’d see virtually no residuals outside the range of -3(12.21) to +3(12.21), or roughly -36.6 to +36.6.</li>
<li>The output at the top of the summary tells us about the observed regression residuals, and that they actually range from -22 to +24.</li>
<li>In context, it’s hard to know whether or not we should be happy about this. On a scale from 0 to 100, rarely missing by more than 24 seems OK to me, but not terrific.</li>
</ul>
</li>
<li>The <strong>degrees of freedom</strong> here are the same as the denominator degrees of freedom in the ANOVA to follow. The calculation is <span class="math inline">\(n - k\)</span>, where <span class="math inline">\(n\)</span> = the number of observations and <span class="math inline">\(k\)</span> is the number of coefficients estimated by the regression (including the intercept and any slopes).
<ul>
<li>Here, there are 36 observations in the model, and we fit <em>k</em> = 2 coefficients; the slope and the intercept, as in any simple regression model, so df = 36 - 2 = 34.</li>
</ul>
</li>
</ul>
<p>The multiple R-squared value is usually just referred to as R-squared.</p>
<ul>
<li>This is interpreted as the proportion of variation in the outcome variable that has been accounted for by our regression model.
<ul>
<li>Here, we’ve accounted for just under 13% of the variation in % Recovery using Dose.</li>
</ul>
</li>
<li>The R in multiple R-squared is the Pearson correlation of <code>recov.score</code> and <code>dose</code>, which in this case is 0.3595.
<ul>
<li>Squaring this value gives the R-squared for this simple regression.</li>
<li>(0.3595)^2 = 0.129</li>
</ul>
</li>
</ul>
<p>R-squared is greedy.</p>
<ul>
<li>R-squared will always suggest that we make our models as big as possible, often including variables of dubious predictive value.</li>
<li>As a result, there are various methods for adjusting or penalizing R-squared so that we wind up with smaller models.</li>
<li>The <strong>adjusted R-squared</strong> is often a useful way to compare multiple models for the same response.
<ul>
<li>
<span class="math inline">\(R^2_{adj} = 1 - \frac{(1-R^2)(n - 1)}{n - k}\)</span>, where <span class="math inline">\(n\)</span> = the number of observations and <span class="math inline">\(k\)</span> is the number of coefficients estimated by the regression (including the intercept and any slopes).</li>
<li>So, in this case, <span class="math inline">\(R^2_{adj} = 1 - \frac{(1 - 0.1293)(35)}{34} = 0.1037\)</span>
</li>
<li>The adjusted R-squared value is not, technically, a proportion of anything, but it is comparable across models for the same outcome.</li>
<li>The adjusted R-squared will always be less than the (unadjusted) R-squared.</li>
</ul>
</li>
</ul>
</div>
<div id="anova-f-test" class="section level3" number="14.7.7">
<h3>
<span class="header-section-number">14.7.7</span> ANOVA F test<a class="anchor" aria-label="anchor" href="#anova-f-test"><i class="fas fa-link"></i></a>
</h3>
<ol start="5" style="list-style-type: decimal">
<li>The last part of the standard summary of a regression model is the overall ANOVA F test.</li>
</ol>
<p>The hypotheses for this test are:</p>
<ul>
<li>H0: Each of the coefficients in the model (other than the intercept) has <span class="math inline">\(\beta\)</span> = 0 vs.</li>
<li>HA: At least one regression slope has <span class="math inline">\(\beta \neq\)</span> 0</li>
</ul>
<p>Since we are doing a simple regression with just one predictor, the ANOVA F test hypotheses are exactly the same as the t test for dose:</p>
<ul>
<li>H0: The slope for <code>dose</code> has <span class="math inline">\(\beta\)</span> = 0 vs.</li>
<li>HA: The slope for <code>dose</code> has <span class="math inline">\(\beta \neq\)</span> 0</li>
</ul>
<p>In this case, we have an F statistic of 5.05 on 1 and 34 degrees of freedom, yielding <em>p</em> = 0.03</p>
<p>This provides some evidence that “something” in our model (here, <code>dose</code> is the only predictor) predicts the outcome to a degree beyond that easily attributed to chance alone. This is not actually surprising, nor is it especially interesting. The confidence interval for the slope is definitely more interesting than this.</p>
<ul>
<li>In <em>simple regression</em> (regression with only one predictor), the t test for the slope (<code>dose</code>) always provides the same p value as the ANOVA F test.
<ul>
<li>The F test statistic in a <em>simple regression</em> is always by definition just the square of the slope’s t test statistic.</li>
<li>Here, F = 5.047, and this is the square of t = 2.247 from the Coefficients output</li>
</ul>
</li>
</ul>
<p>This test is basically just a combination of the R-squared value (13%) and the sample size. We don’t learn much from it that’s practically interesting or useful.</p>
</div>
</div>
<div id="viewing-the-complete-anova-table" class="section level2" number="14.8">
<h2>
<span class="header-section-number">14.8</span> Viewing the complete ANOVA table<a class="anchor" aria-label="anchor" href="#viewing-the-complete-anova-table"><i class="fas fa-link"></i></a>
</h2>
<p>We can obtain the complete ANOVA table associated with this particular model, and the details behind this F test using the <code>anova</code> function:</p>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recov.score</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">hydrate</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: recov.score
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
dose       1  752.2  752.15  5.0473 0.03127 *
Residuals 34 5066.7  149.02                  
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<ul>
<li>The R-squared for our regression model is equal to the <span class="math inline">\(\eta^2\)</span> for this ANOVA model.
<ul>
<li>If we divide SS(dose) = 752.2 by the total sum of squares (752.2 + 5066.7), we’ll get the multiple R-squared [0.1293]</li>
</ul>
</li>
<li>Note that this is <em>not</em> the same ANOVA model we would get if we treated <code>dose</code> as a factor with seven levels, rather than as a quantitative variable.</li>
</ul>
</div>
<div id="using-glance-to-summarize-the-models-fit" class="section level2" number="14.9">
<h2>
<span class="header-section-number">14.9</span> Using <code>glance</code> to summarize the model’s fit<a class="anchor" aria-label="anchor" href="#using-glance-to-summarize-the-models-fit"><i class="fas fa-link"></i></a>
</h2>
<p>When applied to a linear model, the <code>glance</code> function from the <code>broom</code> package summarizes 12 characteristics of the model’s fit.</p>
<p>Let’s look at the eight of these that we’ve already addressed.</p>
<div class="sourceCode" id="cb520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">r.squared</span><span class="op">:</span><span class="va">df</span>, <span class="va">df.residual</span>, <span class="va">nobs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.129</td>
<td align="right">0.104</td>
<td align="right">12.2</td>
<td align="right">5.05</td>
<td align="right">0.031</td>
<td align="right">1</td>
<td align="right">34</td>
<td align="right">36</td>
</tr></tbody>
</table></div>
<ul>
<li>We’ve discussed the R-square value, shown in <code>r.squared</code>.</li>
<li>We’ve also discussed the adjusted R-square value, in <code>adj.r.squared</code>
</li>
<li>
<code>sigma</code> is the residual standard error.</li>
<li>
<code>statistic</code> is the ANOVA F statistic.</li>
<li>
<code>p.value</code> is the <em>p</em> value associated with the ANOVA F statistic.</li>
<li>
<code>df</code> is the numerator degrees of freedom (here, the <code>df</code> associated with <code>dose</code>) for the ANOVA test associated with this model.</li>
<li>
<code>df.residual</code> is the denominator degrees of freedom (here the <code>df</code> associated with <code>residual</code>) for that same ANOVA test.</li>
<li>Remember that the F-statistic at the bottom of the summary output provides these last four statistics, as well.</li>
<li>
<code>nobs</code> is the number of observations (rows) used to fit the model.</li>
</ul>
<p>Now, let’s look at the remaining four summaries:</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">logLik</span><span class="op">:</span><span class="va">deviance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">deviance</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">-140.1</td>
<td align="right">286.3</td>
<td align="right">291</td>
<td align="right">5066.7</td>
</tr></tbody>
</table></div>
<ul>
<li>
<code>logLik</code> is the log-likelihood value for the model, and is most commonly used for a model (like the ordinary least squares model fit by <code>lm</code> that is fit using the method of maximum likelihood). Thus, the log-likelihood value will be maximized in this fit.</li>
<li>
<code>AIC</code> is the Akaike Information Criterion for the model. When comparing models fitted by maximum likelihood to the same outcome variable (using the same transformation, for example), the smaller the AIC, the better the fit.</li>
<li>
<code>BIC</code> is the Bayes Information Criterion for the model. When comparing models fitted by maximum likelihood to the same outcome variable (using the same transformation, for example), the smaller the BIC, the better the fit. BIC often prefers models with fewer coefficients to estimate than does AIC.
<ul>
<li>
<code>AIC</code> and <code>BIC</code> can be estimated using several different approaches in R, but we’ll need to use the same one across multiple models if we’re comparing the results, because the concepts are only defined up to a constant.</li>
</ul>
</li>
<li>
<code>deviance</code> is the fitted model’s deviance, a measure of lack of fit. It is a generalization of the residual sum of squares seen in the ANOVA table, and takes the same value in the case of a simple linear regression model fit with <code>lm</code> as we have here. For some generalized linear models, we’ll use this for hypothesis testing, just as the ANOVA table does in the linear model case.</li>
</ul>
</div>
<div id="plotting-residuals-vs.-fitted-values" class="section level2" number="14.10">
<h2>
<span class="header-section-number">14.10</span> Plotting Residuals vs. Fitted Values<a class="anchor" aria-label="anchor" href="#plotting-residuals-vs.-fitted-values"><i class="fas fa-link"></i></a>
</h2>
<p>To save the residuals and predicted (fitted) values from this simple regression model, we can use the <code>resid</code> and <code>fitted</code> commands, respectively, or we can use the <code>augment</code> function in the <code>broom</code> package to obtain a tidy data set containing these objects and others.</p>
<div class="sourceCode" id="cb522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">F</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Residuals vs. Fitted values for Model m1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk160-1.png" width="672"></div>
<p>We can also obtain a plot of residuals vs. fitted values for <code>m1</code> using the following code from base R.</p>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m1</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="14_hydrate_files/figure-html/c14_chunk170-1.png" width="672"></div>
<p>We hope in this plot to see a generally random scatter of points, perhaps looking like a “fuzzy football.” Since we only have seven possible <code>dose</code> values, we obtain only seven distinct predicted values, which explains the seven vertical lines in the plot. Here, the smooth red line indicates a gentle curve, but no evidence of a strong curve, or any other regular pattern in this residual plot.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="studying-crab-claws-crabs.html"><span class="header-section-number">13</span> Studying Crab Claws (crabs)</a></div>
<div class="next"><a href="WCGS-Study.html"><span class="header-section-number">15</span> The WCGS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#Hydrate-Study"><span class="header-section-number">14</span> Dehydration Recovery</a></li>
<li><a class="nav-link" href="#a-scatterplot-matrix"><span class="header-section-number">14.1</span> A Scatterplot Matrix</a></li>
<li><a class="nav-link" href="#are-the-recovery-scores-well-described-by-a-normal-model"><span class="header-section-number">14.2</span> Are the recovery scores well described by a Normal model?</a></li>
<li><a class="nav-link" href="#simple-regression-using-dose-to-predict-recovery"><span class="header-section-number">14.3</span> Simple Regression: Using Dose to predict Recovery</a></li>
<li><a class="nav-link" href="#the-scatterplot-with-fitted-linear-model"><span class="header-section-number">14.4</span> The Scatterplot, with fitted Linear Model</a></li>
<li>
<a class="nav-link" href="#the-fitted-linear-model"><span class="header-section-number">14.5</span> The Fitted Linear Model</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#confidence-intervals"><span class="header-section-number">14.5.1</span> Confidence Intervals</a></li></ul>
</li>
<li><a class="nav-link" href="#coefficient-plots"><span class="header-section-number">14.6</span> Coefficient Plots</a></li>
<li>
<a class="nav-link" href="#the-summary-output"><span class="header-section-number">14.7</span> The Summary Output</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#model-specification"><span class="header-section-number">14.7.1</span> Model Specification</a></li>
<li><a class="nav-link" href="#residual-summary"><span class="header-section-number">14.7.2</span> Residual Summary</a></li>
<li><a class="nav-link" href="#coefficients-output"><span class="header-section-number">14.7.3</span> Coefficients Output</a></li>
<li><a class="nav-link" href="#correlation-and-slope"><span class="header-section-number">14.7.4</span> Correlation and Slope</a></li>
<li><a class="nav-link" href="#coefficient-testing"><span class="header-section-number">14.7.5</span> Coefficient Testing</a></li>
<li><a class="nav-link" href="#summarizing-the-quality-of-fit"><span class="header-section-number">14.7.6</span> Summarizing the Quality of Fit</a></li>
<li><a class="nav-link" href="#anova-f-test"><span class="header-section-number">14.7.7</span> ANOVA F test</a></li>
</ul>
</li>
<li><a class="nav-link" href="#viewing-the-complete-anova-table"><span class="header-section-number">14.8</span> Viewing the complete ANOVA table</a></li>
<li><a class="nav-link" href="#using-glance-to-summarize-the-models-fit"><span class="header-section-number">14.9</span> Using glance to summarize the model’s fit</a></li>
<li><a class="nav-link" href="#plotting-residuals-vs.-fitted-values"><span class="header-section-number">14.10</span> Plotting Residuals vs. Fitted Values</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/THOMASELOVE/431-notes/blob/master/14_hydrate.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/THOMASELOVE/431-notes/edit/master/14_hydrate.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</strong>" was written by Thomas E. Love. It was last built on 2021-10-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
