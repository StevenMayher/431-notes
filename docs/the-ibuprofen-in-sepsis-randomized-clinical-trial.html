<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 17 The Ibuprofen in Sepsis Randomized Clinical Trial | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
<meta name="author" content="Thomas E. Love">
<meta name="description" content="Our next study is a randomized controlled trial comparing ibuprofen vs. placebo in patients with sepsis, which uses an independent samples design to compare two samples of quantitative data. We...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 17 The Ibuprofen in Sepsis Randomized Clinical Trial | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta property="og:type" content="book">
<meta property="og:url" content="https://thomaselove.github.io/431-notes/the-ibuprofen-in-sepsis-randomized-clinical-trial.html">
<meta property="og:description" content="Our next study is a randomized controlled trial comparing ibuprofen vs. placebo in patients with sepsis, which uses an independent samples design to compare two samples of quantitative data. We...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 17 The Ibuprofen in Sepsis Randomized Clinical Trial | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta name="twitter:description" content="Our next study is a randomized controlled trial comparing ibuprofen vs. placebo in patients with sepsis, which uses an independent samples design to compare two samples of quantitative data. We...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Working with These Notes</a></li>
<li><a class="" href="data-science.html"><span class="header-section-number">1</span> Data Science</a></li>
<li class="book-part">Part A. Exploring Data</li>
<li><a class="" href="the-palmer-penguins.html"><span class="header-section-number">2</span> The Palmer Penguins</a></li>
<li><a class="" href="nhanes1.html"><span class="header-section-number">3</span> NHANES: A First Look</a></li>
<li><a class="" href="data-structures-variable-types-sampling-nhanes.html"><span class="header-section-number">4</span> Data Structures, Variable Types &amp; Sampling NHANES</a></li>
<li><a class="" href="visualizing-nhanes-data.html"><span class="header-section-number">5</span> Visualizing NHANES Data</a></li>
<li><a class="" href="summarizing_quantities.html"><span class="header-section-number">6</span> Summarizing Quantities</a></li>
<li><a class="" href="summarizing-categories.html"><span class="header-section-number">7</span> Summarizing Categories</a></li>
<li><a class="" href="miss.html"><span class="header-section-number">8</span> Missing Data and Single Imputation</a></li>
<li><a class="" href="NYFS-Study.html"><span class="header-section-number">9</span> National Youth Fitness Survey</a></li>
<li><a class="" href="assessing-normality.html"><span class="header-section-number">10</span> Assessing Normality</a></li>
<li><a class="" href="straight-line-models.html"><span class="header-section-number">11</span> Straight Line Models</a></li>
<li><a class="" href="linearizing-transformations.html"><span class="header-section-number">12</span> Linearizing Transformations</a></li>
<li><a class="" href="studying-crab-claws-crabs.html"><span class="header-section-number">13</span> Studying Crab Claws (crabs)</a></li>
<li><a class="" href="Hydrate-Study.html"><span class="header-section-number">14</span> Dehydration Recovery</a></li>
<li><a class="" href="WCGS-Study.html"><span class="header-section-number">15</span> The WCGS</a></li>
<li class="book-part">Part B. Comparing Summaries</li>
<li><a class="" href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></li>
<li><a class="active" href="the-ibuprofen-in-sepsis-randomized-clinical-trial.html"><span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial</a></li>
<li><a class="" href="comparing-means-with-paired-samples.html"><span class="header-section-number">18</span> Comparing Means with Paired Samples</a></li>
<li><a class="" href="hypothesis-testing-what-is-it-good-for.html"><span class="header-section-number">19</span> Hypothesis Testing: What is it good for?</a></li>
<li><a class="" href="two-examples-comparing-means.html"><span class="header-section-number">20</span> Two Examples Comparing Means</a></li>
<li><a class="" href="estimating-a-population-proportion.html"><span class="header-section-number">21</span> Estimating a Population Proportion</a></li>
<li><a class="" href="comparing-proportions-with-two-independent-samples.html"><span class="header-section-number">22</span> Comparing Proportions with Two Independent Samples</a></li>
<li><a class="" href="power-and-proportions.html"><span class="header-section-number">23</span> Power and Proportions</a></li>
<li><a class="" href="larger-contingency-tables.html"><span class="header-section-number">24</span> Larger Contingency Tables</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">25</span> Analysis of Variance</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="some-r-tips.html">Some R Tips</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/THOMASELOVE/431-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="the-ibuprofen-in-sepsis-randomized-clinical-trial" class="section level1" number="17">
<h1>
<span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial<a class="anchor" aria-label="anchor" href="#the-ibuprofen-in-sepsis-randomized-clinical-trial"><i class="fas fa-link"></i></a>
</h1>
<p>Our next study is a randomized controlled trial comparing ibuprofen vs. placebo in patients with sepsis, which uses an <em>independent samples</em> design to compare two samples of quantitative data. We will be working with a sample from the Ibuprofen in Sepsis study, which is also studied in <span class="citation"><a href="references.html#ref-Dupont" role="doc-biblioref">William D. Dupont</a>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references.html#ref-Dupont" role="doc-biblioref"&gt;&lt;em&gt;Statistical Modeling for Biomedical Researchers&lt;/em&gt; (New York: Cambridge University Press, 2002)&lt;/a&gt;.&lt;/p&gt;'><sup>39</sup></a></span> Quoting the abstract from <span class="citation"><a href="references.html#ref-Bernard1997" role="doc-biblioref">Gordon R. Bernard et al.</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references.html#ref-Bernard1997" role="doc-biblioref"&gt;&lt;span&gt;“The Effects of Ibuprofen on the Physiology and Survival of Patients with Sepsis,”&lt;/span&gt; &lt;em&gt;New England Journal of Medicine&lt;/em&gt; 336 (1997): 912–18, &lt;/a&gt;&lt;a href="http://www.nejm.org/doi/full/10.1056/NEJM199703273361303#t=article" role="doc-biblioref"&gt;http://www.nejm.org/doi/full/10.1056/NEJM199703273361303#t=article&lt;/a&gt;.&lt;/p&gt;'><sup>40</sup></a></span></p>
<blockquote>
<p>Ibuprofen has been shown to have effects on sepsis in humans, but because of their small samples (fewer than 30 patients), previous studies have been inadequate to assess effects on mortality. We sought to determine whether ibuprofen can alter rates of organ failure and mortality in patients with the sepsis syndrome, how the drug affects the increased metabolic demand in sepsis (e.g., fever, tachypnea, tachycardia, hypoxemia, and lactic acidosis), and what potential adverse effects the drug has in the sepsis syndrome.</p>
</blockquote>
<p>In this study, patients meeting specific criteria (including elevated temperature) for a diagnosis of sepsis were recruited if they fulfilled an additional set of study criteria in the intensive care unit at one of seven participating centers.</p>
<p>The full trial involved 455 patients, of which our sample includes 300. 150 of our patients were randomly assigned to the Ibuprofen group and 150 to the Placebo group<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This was a &lt;em&gt;double-blind&lt;/em&gt; study, where neither the patients nor their care providers know, during the execution of the trial, what intervention group was assigned to each patient.&lt;/p&gt;"><sup>41</sup></a>. I picked the <code>sepsis</code> sample we will work with excluding patients with missing values for our outcome of interest, and then selected a random sample of 150 Ibuprofen and 150 Placebo patients from the rest of the group, and converted the temperatures and changes from Fahrenheit to Celsius. The data are gathered in the <code>sepsis</code> data file.</p>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/sepsis.csv"</span><span class="op">)</span></code></pre></div>
<p>For the moment, we focus on two variables:</p>
<ul>
<li>
<strong>treat</strong>, which specifies the treatment group (intravenous Ibuprofen or intravenous Placebo), which was assigned via randomization to each patient, and</li>
<li>
<strong>temp_drop</strong>, the outcome of interest, measured as the change from baseline to 2 hours later in degrees Celsius. Positive values indicate improvement, that is, a <em>drop</em> in temperature over the 2 hours following the baseline measurement.</li>
</ul>
<p>The <code>sepsis.csv</code> file also contains each subject’s</p>
<ul>
<li>
<em>id</em>, which is just a code</li>
<li>
<em>race</em> (three levels: White, AfricanA or Other)</li>
<li>
<em>apache</em> = baseline APACHE II score, a severity of disease score ranging from 0 to 71 with higher scores indicating more severe disease and a higher mortality risk</li>
<li>
<em>temp_0</em> = baseline temperature, degrees Celsius.</li>
</ul>
<p>but for the moment, we won’t worry about those.</p>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>treat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">treat</span><span class="op">)</span>,
           race <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sepsis</span><span class="op">)</span></code></pre></div>
<pre><code>      id                  treat           race    
 Length:300         Ibuprofen:150   AfricanA: 80  
 Class :character   Placebo  :150   Other   : 23  
 Mode  :character                   White   :197  
                                                  
                                                  
                                                  
     apache         temp_0        temp_drop      
 Min.   : 0.0   Min.   :33.10   Min.   :-2.7000  
 1st Qu.:10.0   1st Qu.:37.48   1st Qu.:-0.1000  
 Median :14.0   Median :38.20   Median : 0.3000  
 Mean   :15.4   Mean   :38.00   Mean   : 0.3083  
 3rd Qu.:20.0   3rd Qu.:38.70   3rd Qu.: 0.7000  
 Max.   :35.0   Max.   :41.70   Max.   : 3.1000  </code></pre>
<div id="comparing-two-groups" class="section level2" number="17.1">
<h2>
<span class="header-section-number">17.1</span> Comparing Two Groups<a class="anchor" aria-label="anchor" href="#comparing-two-groups"><i class="fas fa-link"></i></a>
</h2>
<p>In making a choice between two alternatives, questions such as the following become paramount.</p>
<ul>
<li>Is there a status quo?</li>
<li>Is there a standard approach?</li>
<li>What are the costs of incorrect decisions?</li>
<li>Are such costs balanced?</li>
</ul>
<p>The process of comparing the means/medians/proportions/rates of the populations represented by two independently obtained samples can be challenging, and such an approach is not always the best choice. Often, specially designed experiments can be more informative at lower cost (i.e. smaller sample size). As one might expect, using these more sophisticated procedures introduces trade-offs, but the costs are typically small relative to the gain in information.</p>
<p>When faced with such a comparison of two alternatives, a test based on <strong>paired</strong> data is often much better than a test based on two distinct, independent samples. Why? If we have done our experiment properly, the pairing lets us eliminate background variation that otherwise hides meaningful differences.</p>
<div id="model-based-comparisons-and-anovaregression" class="section level3" number="17.1.1">
<h3>
<span class="header-section-number">17.1.1</span> Model-Based Comparisons and ANOVA/Regression<a class="anchor" aria-label="anchor" href="#model-based-comparisons-and-anovaregression"><i class="fas fa-link"></i></a>
</h3>
<p>Comparisons based on independent samples of quantitative variables are also frequently accomplished through other equivalent methods, including the analysis of variance approach and dummy variable regression, both of which produce identical confidence intervals to the pooled variance t test for the same comparison.</p>
<p>We will also discuss some of the main ideas in developing, designing and analyzing statistical experiments, specifically in terms of making comparisons. The ideas we will present in this section allow for the comparison of more than two populations in terms of their population means. The statistical techniques employed analyze the sample variance in order to test and estimate the population means and for this reason the method is called the analysis of variance (ANOVA), and we will discuss this approach alone, and within the context of a linear regression model using dummy or indicator variables.</p>
</div>
</div>
<div id="key-questions-for-comparing-with-independent-samples" class="section level2" number="17.2">
<h2>
<span class="header-section-number">17.2</span> Key Questions for Comparing with Independent Samples<a class="anchor" aria-label="anchor" href="#key-questions-for-comparing-with-independent-samples"><i class="fas fa-link"></i></a>
</h2>
<div id="what-is-the-population-under-study" class="section level3" number="17.2.1">
<h3>
<span class="header-section-number">17.2.1</span> What is the <strong>population</strong> under study?<a class="anchor" aria-label="anchor" href="#what-is-the-population-under-study"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>All patients in the intensive care unit with sepsis who meet the inclusion and exclusion criteria of the study, at the entire population of health centers like the ones included in the trial.</li>
</ul>
</div>
<div id="what-is-the-sample-is-it-representative-of-the-population" class="section level3" number="17.2.2">
<h3>
<span class="header-section-number">17.2.2</span> What is the <strong>sample</strong>? Is it representative of the population?<a class="anchor" aria-label="anchor" href="#what-is-the-sample-is-it-representative-of-the-population"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The sample consists of 300 patients. It is a convenient sample from the population under study.</li>
<li>This is a randomized clinical trial. 150 of the patients were assigned to Ibuprofen, and the rest to Placebo. It is this treatment assignment that is randomized, not the selection of the sample as a whole.</li>
<li>In expectation, randomization of individuals to treatments, as in this study, should be expected to eliminate treatment selection bias.</li>
</ul>
</div>
<div id="who-are-the-subjects-individuals-within-the-sample" class="section level3" number="17.2.3">
<h3>
<span class="header-section-number">17.2.3</span> Who are the subjects / <strong>individuals</strong> within the sample?<a class="anchor" aria-label="anchor" href="#who-are-the-subjects-individuals-within-the-sample"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>150 patients who received Ibuprofen and a completely different set of 150 patients who received Placebo.</li>
<li>There is no match or link between the patients. They are best thought of as independent samples.</li>
</ul>
</div>
<div id="what-data-are-available-on-each-individual" class="section level3" number="17.2.4">
<h3>
<span class="header-section-number">17.2.4</span> What <strong>data</strong> are available on each individual?<a class="anchor" aria-label="anchor" href="#what-data-are-available-on-each-individual"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The key variables are the treatment indicator (Ibuprofen or Placebo) and the outcome (drop in temperature in the 2 hours following administration of the randomly assigned treatment.)</li>
</ul>
</div>
<div id="rct-caveats" class="section level3" number="17.2.5">
<h3>
<span class="header-section-number">17.2.5</span> RCT Caveats<a class="anchor" aria-label="anchor" href="#rct-caveats"><i class="fas fa-link"></i></a>
</h3>
<p>The placebo-controlled, double-blind randomized clinical trial, especially if pre-registered, is often considered the best feasible study for assessing the effectiveness of a treatment. While that’s not always true, it is a very solid design. The primary caveat is that the patients who are included in such trials are rarely excellent representations of the population of potentially affected patients as a whole.</p>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2" number="17.3">
<h2>
<span class="header-section-number">17.3</span> Exploratory Data Analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the following boxplot with violin of the <code>temp_drop</code> data within each <code>treat</code> group.</p>
<div class="sourceCode" id="cb630"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treat</span>, y <span class="op">=</span> <span class="va">temp_drop</span>, fill <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot of Temperature Drop in Sepsis Patients"</span>,
         x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Drop in Temperature (degrees C)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<p>Next, we’ll consider faceted histograms of the data.</p>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temp_drop</span>, fill <span class="op">=</span> <span class="va">treat</span>, color <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, color <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histograms of Temperature Drop in Sepsis Patients"</span>,
         x <span class="op">=</span> <span class="st">"Drop in Temperature (degrees Celsius"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">treat</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/sepsis_temp_drop_by_treat_histograms-1.png" width="672"></div>
<p>Here’s a pair of Normal Q-Q plots. It’s not hard to use a Normal model to approximate the Ibuprofen data, but such a model is probably not a good choice for the Placebo results.</p>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">temp_drop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">treat</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature Drop Values (in degrees C)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<p>We’ll could perhaps also look at a ridgeline plot.</p>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temp_drop</span>, y <span class="op">=</span> <span class="va">treat</span>, fill <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Temperature Drop in Sepsis Patients"</span>,
         x <span class="op">=</span> <span class="st">"Drop in Temperature (degrees Celsius)"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/theme_ridges.html">theme_ridges</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Picking joint bandwidth of 0.182</code></pre>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<p>The center of the ibuprofen distribution is shifted a bit towards the more positive (greater improvement) direction, it seems, than is the distribution for the placebo patients. This conclusion matches what we see in some key numerical summaries, within the treatment groups.</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span></code></pre></div>
<pre><code>      treat  min     Q1 median  Q3 max      mean        sd
1 Ibuprofen -1.5  0.000    0.5 0.9 3.1 0.4640000 0.6877919
2   Placebo -2.7 -0.175    0.1 0.4 1.9 0.1526667 0.5709637
    n missing
1 150       0
2 150       0</code></pre>
</div>
<div id="estimating-the-difference-in-population-means" class="section level2" number="17.4">
<h2>
<span class="header-section-number">17.4</span> Estimating the Difference in Population Means<a class="anchor" aria-label="anchor" href="#estimating-the-difference-in-population-means"><i class="fas fa-link"></i></a>
</h2>
<p>Next, we will build a point estimate and 90% confidence interval for the difference between the mean <code>temp_drop</code> if treated with Ibuprofen and the mean <code>temp_drop</code> if treated with Placebo. We’ll use a regression model with a single predictor (the <code>treat</code> group) to do this.</p>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_sep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">==</span> <span class="st">"Ibuprofen"</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model_sep</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.153</td>
<td align="right">0.052</td>
<td align="right">2.958</td>
<td align="right">0.003</td>
<td align="right">0.068</td>
<td align="right">0.238</td>
</tr>
<tr class="even">
<td align="left">treat == “Ibuprofen”TRUE</td>
<td align="right">0.311</td>
<td align="right">0.073</td>
<td align="right">4.266</td>
<td align="right">0.000</td>
<td align="right">0.191</td>
<td align="right">0.432</td>
</tr>
</tbody>
</table></div>
<p>The point estimate for the “Ibuprofen - Placebo” difference in population means is 0.311 degrees C, and the 90% confidence interval is (0.191, 0.432) degrees C.</p>
<p>We could also have run the model like this:</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_sep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model_sep2</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.464</td>
<td align="right">0.052</td>
<td align="right">8.991</td>
<td align="right">0</td>
<td align="right">0.379</td>
<td align="right">0.549</td>
</tr>
<tr class="even">
<td align="left">treatPlacebo</td>
<td align="right">-0.311</td>
<td align="right">0.073</td>
<td align="right">-4.266</td>
<td align="right">0</td>
<td align="right">-0.432</td>
<td align="right">-0.191</td>
</tr>
</tbody>
</table></div>
<p>and would therefore conclude that the <em>Placebo - Ibuprofen</em> difference was estimated as -0.311, with 90% confidence interval (-0.432, -0.191), which is of course equivalent to our previous estimate.</p>
<p>Fundamentally, this regression model approach is identical to a <strong>two-sample t test, assuming equal population variances</strong>, also called a <strong>pooled t test</strong>. This is just one possible way for us to estimate the difference between population means, as it turns out.</p>
</div>
<div id="t-based-ci-for-population-mean1---mean2-difference" class="section level2" number="17.5">
<h2>
<span class="header-section-number">17.5</span> t-based CI for population mean1 - mean2 difference<a class="anchor" aria-label="anchor" href="#t-based-ci-for-population-mean1---mean2-difference"><i class="fas fa-link"></i></a>
</h2>
<div id="the-pooled-t-procedure" class="section level3" number="17.5.1">
<h3>
<span class="header-section-number">17.5.1</span> The Pooled t procedure<a class="anchor" aria-label="anchor" href="#the-pooled-t-procedure"><i class="fas fa-link"></i></a>
</h3>
<p>The most commonly used t-procedure for building a confidence interval assumes not only that each of the two populations being compared follows a Normal distribution, but also that they have the same population variance. This is the pooled t-test, and it is what people usually mean when they describe a two-sample t test.</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                  alt <span class="op">=</span> <span class="st">"two.sided"</span>,
                  var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  temp_drop by treat
t = 4.2656, df = 298, p-value = 2.68e-05
alternative hypothesis: true difference in means between group Ibuprofen and group Placebo is not equal to 0
90 percent confidence interval:
 0.1909066 0.4317600
sample estimates:
mean in group Ibuprofen   mean in group Placebo 
              0.4640000               0.1526667 </code></pre>
<p>Or, we can use <code>tidy</code> on this object:</p>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tt1</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                  alt <span class="op">=</span> <span class="st">"two.sided"</span>,
                  var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">tt1</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 10
  estimate estimate1 estimate2 statistic   p.value parameter
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1    0.311     0.464     0.153      4.27 0.0000268       298
# ... with 4 more variables: conf.low &lt;dbl&gt;,
#   conf.high &lt;dbl&gt;, method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
<div id="using-linear-regression-to-obtain-a-pooled-t-confidence-interval" class="section level3" number="17.5.2">
<h3>
<span class="header-section-number">17.5.2</span> Using linear regression to obtain a pooled t confidence interval<a class="anchor" aria-label="anchor" href="#using-linear-regression-to-obtain-a-pooled-t-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>As we’ve seen, and will demonstrate again below, a linear regression model, using the same outcome and predictor (group) as the pooled t procedure, produces the same confidence interval, again, under the assumption that the two populations we are comparing follow a Normal distribution with the same (population) variance.</p>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 2 x 7
  term         estimate std.error statistic  p.value conf.low
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     0.464    0.0516      8.99 2.91e-17    0.379
2 treatPlacebo   -0.311    0.0730     -4.27 2.68e- 5   -0.432
# ... with 1 more variable: conf.high &lt;dbl&gt;</code></pre>
<p>We see that our point estimate from the linear regression model is that the difference in <code>temp_drop</code> is -0.3113333, where Ibuprofen subjects have higher <code>temp_drop</code> values than do Placebo subjects, and that the 90% confidence interval for this difference ranges from -0.43176 to -0.1909066.</p>
<p>We can obtain a t-based confidence interval for each of the parameter estimates in a linear model directly using <code>tidy</code> from the <code>broom</code> package. Linear models usually summarize only the estimate and standard error. Remember that a reasonable approximation in large samples to a 95% confidence interval for a regression estimate (slope or intercept) can be obtained from estimate plus or minus two times the standard error.</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.464</td>
<td align="right">0.052</td>
<td align="right">8.991</td>
<td align="right">0</td>
<td align="right">0.362</td>
<td align="right">0.566</td>
</tr>
<tr class="even">
<td align="left">treatPlacebo</td>
<td align="right">-0.311</td>
<td align="right">0.073</td>
<td align="right">-4.266</td>
<td align="right">0</td>
<td align="right">-0.455</td>
<td align="right">-0.168</td>
</tr>
</tbody>
</table></div>
<p>So, in the case of the <code>treatPlacebo</code> estimate, we can obtain an approximate 95% confidence interval with (-0.457, -0.165). Compare this to the 95% confidence interval available from the model directly, shown in the tidied output above, or with the <code>confint</code> command below, and you’ll see only a small difference.</p>
<p>Note that we can also use <code>summary</code> and <code>confint</code> to build our estimates.</p>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = temp_drop ~ treat, data = sepsis)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.85267 -0.36400 -0.05267  0.34733  2.63600 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.46400    0.05161   8.991  &lt; 2e-16 ***
treatPlacebo -0.31133    0.07299  -4.266 2.68e-05 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6321 on 298 degrees of freedom
Multiple R-squared:  0.05755,   Adjusted R-squared:  0.05438 
F-statistic:  18.2 on 1 and 298 DF,  p-value: 2.68e-05</code></pre>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/confint.html">confint</a></span><span class="op">(</span><span class="va">model1</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<pre><code>                  2.5 %     97.5 %
(Intercept)   0.3624351  0.5655649
treatPlacebo -0.4549679 -0.1676988</code></pre>
</div>
<div id="the-welch-t-procedure" class="section level3" number="17.5.3">
<h3>
<span class="header-section-number">17.5.3</span> The Welch t procedure<a class="anchor" aria-label="anchor" href="#the-welch-t-procedure"><i class="fas fa-link"></i></a>
</h3>
<p>The default confidence interval based on the t test for independent samples in R uses something called the Welch test, in which the two populations being compared are not assumed to have the same variance. Each population is assumed to follow a Normal distribution.</p>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span>, 
                  alt <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  temp_drop by treat
t = 4.2656, df = 288.24, p-value = 2.706e-05
alternative hypothesis: true difference in means between group Ibuprofen and group Placebo is not equal to 0
90 percent confidence interval:
 0.1908939 0.4317728
sample estimates:
mean in group Ibuprofen   mean in group Placebo 
              0.4640000               0.1526667 </code></pre>
<p>Tidying works in this situation, too.</p>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tt0</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span>, 
                  alt <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">tt0</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 10
  estimate estimate1 estimate2 statistic   p.value parameter
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1    0.311     0.464     0.153      4.27 0.0000271      288.
# ... with 4 more variables: conf.low &lt;dbl&gt;,
#   conf.high &lt;dbl&gt;, method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
<p>When there is a <em>balanced design</em>, that is, when the same number of observations appear in each of the two samples, then the Welch t test and the Pooled t test produce the same confidence interval. Differences appear if the sample sizes in the two groups being compared are different.</p>
</div>
</div>
<div id="wilcoxon-mann-whitney-rank-sum-ci" class="section level2" number="17.6">
<h2>
<span class="header-section-number">17.6</span> Wilcoxon-Mann-Whitney “Rank Sum” CI<a class="anchor" aria-label="anchor" href="#wilcoxon-mann-whitney-rank-sum-ci"><i class="fas fa-link"></i></a>
</h2>
<p>As in the one-sample case, a rank-based alternative attributed to Wilcoxon (and sometimes to Mann and Whitney) provides a two-sample comparison of the pseudomedians in the two <code>treat</code> groups in terms of <code>temp_drop</code>. This is called a <strong>rank sum</strong> test, rather than the Wilcoxon <strong>signed rank</strong> test that is used for inference about a single sample. Here’s the resulting 90% confidence interval for the difference in pseudomedians.</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wt</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                       conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                       alt <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span> 

<span class="va">wt</span></code></pre></div>
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  temp_drop by treat
W = 14614, p-value = 7.281e-06
alternative hypothesis: true location shift is not equal to 0
90 percent confidence interval:
 0.1999699 0.4000330
sample estimates:
difference in location 
             0.3000368 </code></pre>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 7
  estimate statistic    p.value conf.low conf.high method   
     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1    0.300    14614. 0.00000728    0.200     0.400 Wilcoxon~
# ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
<div id="bootstrapping-a-more-robust-approach" class="section level2" number="17.7">
<h2>
<span class="header-section-number">17.7</span> Bootstrapping: A More Robust Approach<a class="anchor" aria-label="anchor" href="#bootstrapping-a-more-robust-approach"><i class="fas fa-link"></i></a>
</h2>
<p>Within a script called <code>Love-boost.R</code>, I have provided the following R code to create a function called <code>bootdif</code>.</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bootdif</span> <span class="op">&lt;-</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">g</span>, <span class="va">conf.level</span><span class="op">=</span><span class="fl">0.95</span>, <span class="va">B.reps</span> <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">lowq</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">conf.level</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/smean.sd.html">smean.cl.boot</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">g</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, B<span class="op">=</span><span class="va">B.reps</span>, reps<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="st">'reps'</span><span class="op">)</span>
    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/smean.sd.html">smean.cl.boot</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">g</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, B<span class="op">=</span><span class="va">B.reps</span>, reps<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="st">'reps'</span><span class="op">)</span>
    <span class="va">meandif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">g</span>, <span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="va">a.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">quantile</a></span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="va">a</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lowq</span>,<span class="fl">1</span><span class="op">-</span><span class="va">lowq</span><span class="op">)</span><span class="op">)</span>
    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">meandif</span>, <span class="va">a.b</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Mean Difference'</span>,<span class="va">lowq</span>, <span class="fl">1</span><span class="op">-</span><span class="va">lowq</span><span class="op">)</span>
    <span class="va">res</span>
  <span class="op">}</span></code></pre></div>
<p>Running this code will place a new function called <code>bootdif</code> in your environment, which will help us calculate an appropriate confidence interval using a bootstrap procedure. The <code>bootdif</code> function contained in the <code>Love-boost.R</code> script is a slightly edited version of the function at <a href="http://biostat.mc.vanderbilt.edu/wiki/Main/BootstrapMeansSoftware" class="uri">http://biostat.mc.vanderbilt.edu/wiki/Main/BootstrapMeansSoftware</a>.</p>
<div id="bootstrap-ci-for-the-sepsis-study" class="section level3" number="17.7.1">
<h3>
<span class="header-section-number">17.7.1</span> Bootstrap CI for the Sepsis study<a class="anchor" aria-label="anchor" href="#bootstrap-ci-for-the-sepsis-study"><i class="fas fa-link"></i></a>
</h3>
<p>Note that this approach uses a comma to separate the outcome variable (here, <code>temp_drop</code>) from the variable identifying the exposure groups (here, <code>treat</code>).</p>
<div class="sourceCode" id="cb659"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">431212</span><span class="op">)</span>

<span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu">bootdif</span><span class="op">(</span><span class="va">temp_drop</span>, <span class="va">treat</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></code></pre></div>
<pre><code>Mean Difference            0.05            0.95 
     -0.3113333      -0.4313667      -0.1833000 </code></pre>
<p>This approach calculates a 90% confidence interval for the difference in means between the two treatment groups. Note that the sign is in the opposite direction from what we’ve seen in our previous work. We can tell from the mean difference (and the summarized means from the data in each group) that this approach is finding a confidence interval using a bootstrap procedure for the Placebo - Ibuprofen difference, specifically (-0.431, -0.183).</p>
<div class="sourceCode" id="cb661"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span></code></pre></div>
<pre><code>      treat  min     Q1 median  Q3 max      mean        sd
1 Ibuprofen -1.5  0.000    0.5 0.9 3.1 0.4640000 0.6877919
2   Placebo -2.7 -0.175    0.1 0.4 1.9 0.1526667 0.5709637
    n missing
1 150       0
2 150       0</code></pre>
<p>To find a confidence interval using this bootstrap approach for the Ibuprofen - Placebo difference, we just need to switch the signs, and conclude that the 90% bootstrap confidence interval for that difference would be (0.183, 0.431).</p>
</div>
</div>
<div id="summary-specifying-a-two-sample-study-design" class="section level2" number="17.8">
<h2>
<span class="header-section-number">17.8</span> Summary: Specifying A Two-Sample Study Design<a class="anchor" aria-label="anchor" href="#summary-specifying-a-two-sample-study-design"><i class="fas fa-link"></i></a>
</h2>
<p>These questions will help specify the details of the study design involved in any comparison of two populations on a quantitative outcome, perhaps with means.</p>
<ol style="list-style-type: decimal">
<li>What is the outcome under study?</li>
<li>What are the (in this case, two) treatment/exposure groups?</li>
<li>Were the data collected using matched / paired samples or independent samples?</li>
<li>Are the data a random sample from the population(s) of interest? Or is there at least a reasonable argument for generalizing from the sample to the population(s)?</li>
<li>What is the significance level (or, the confidence level) we require here?</li>
<li>Are we doing one-sided or two-sided testing/confidence interval generation?</li>
<li>If we have paired samples, did pairing help reduce nuisance variation?</li>
<li>If we have paired samples, what does the distribution of sample paired differences tell us about which inferential procedure to use?</li>
<li>If we have independent samples, what does the distribution of each individual sample tell us about which inferential procedure to use?</li>
</ol>
</div>
<div id="results-for-the-sepsis-study" class="section level2" number="17.9">
<h2>
<span class="header-section-number">17.9</span> Results for the <code>sepsis</code> study<a class="anchor" aria-label="anchor" href="#results-for-the-sepsis-study"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>The outcome is <code>temp_drop</code>, the change in body temperature (in <span class="math inline">\(^{\circ}\)</span>C) from baseline to 2 hours later, so that positive numbers indicate drops in temperature (a good outcome.)</li>
<li>The groups are <strong>Ibuprofen</strong> and <strong>Placebo</strong> as contained in the <code>treat</code> variable in the <code>sepsis</code> tibble.</li>
<li>The data were collected using independent samples. The Ibuprofen subjects are not matched or linked to individual Placebo subjects - they are separate groups.</li>
<li>The subjects of the study aren’t drawn from a random sample of the population of interest, but they are randomly assigned to their respective treatments (Ibuprofen and Placebo) which will provide the reasoned basis for our inferences.</li>
<li>We’ll use a 10% significance level (or 90% confidence level) in this setting, as we did in our previous work on these data.</li>
<li>We’ll use a two-sided testing and confidence interval approach.</li>
</ol>
<p>Questions 7 and 8 don’t apply, because these are independent samples of data, rather than paired samples.</p>
<p>To address question 9, we’ll need to look at the data in each sample, as we did previously to allow us to assess the Normality of the distributions of (separately) the <code>temp_drop</code> results in the Ibuprofen and Placebo groups. We’ll repeat those below.</p>
<div class="sourceCode" id="cb663"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treat</span>, y <span class="op">=</span> <span class="va">temp_drop</span>, fill <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot of Temperature Drop in Sepsis Patients"</span>,
         x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Drop in Temperature (degrees C)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sepsis</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">temp_drop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">treat</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature Drop Values (in degrees C)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="17_IbuprofeninSepsisRCT_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
<p>From these plots we conclude that the data in the Ibuprofen sample follow a reasonably Normal distribution, but this isn’t quite as true for the Placebo sample. It’s hard to know whether the apparent Placebo group outliers will affect whether the Normal distribution assumption is reasonable, so we can see if the confidence intervals change much when we <em>don’t</em> assume Normality (for instance, comparing the bootstrap to the t-based approaches), as a way of understanding whether a Normal model has a large impact on our conclusions.</p>
<div id="sepsis-estimation-results" class="section level3" number="17.9.1">
<h3>
<span class="header-section-number">17.9.1</span> Sepsis Estimation Results<a class="anchor" aria-label="anchor" href="#sepsis-estimation-results"><i class="fas fa-link"></i></a>
</h3>
<p>Here’s a set of confidence interval estimates (we’ll use 90% confidence here) using the methods discussed in this Chapter.</p>
<div class="sourceCode" id="cb665"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">sepsis</span><span class="op">)</span></code></pre></div>
<pre><code>      treat  min     Q1 median  Q3 max      mean        sd
1 Ibuprofen -1.5  0.000    0.5 0.9 3.1 0.4640000 0.6877919
2   Placebo -2.7 -0.175    0.1 0.4 1.9 0.1526667 0.5709637
    n missing
1 150       0
2 150       0</code></pre>
<div class="sourceCode" id="cb667"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_pooled_t_test</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, 
                           conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                           alt <span class="op">=</span> <span class="st">"two.sided"</span>, 
                           var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">s_pooled_t_test</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1    0.191     0.432</code></pre>
<div class="sourceCode" id="cb669"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_welch_t_test</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/ttest.html">t.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>, 
                           conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                           alt <span class="op">=</span> <span class="st">"two.sided"</span>, 
                           var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">s_welch_t_test</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1    0.311    0.191     0.432</code></pre>
<div class="sourceCode" id="cb671"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_wilcoxon_test</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">~</span> <span class="va">treat</span>,
                       conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span>,
                       alt <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span> 

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">s_wilcoxon_test</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1    0.300    0.200     0.400</code></pre>
<div class="sourceCode" id="cb673"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">431212</span><span class="op">)</span>
<span class="va">s_bootstrap</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu">bootdif</span><span class="op">(</span><span class="va">temp_drop</span>, <span class="va">treat</span>, 
                                  conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>

<span class="va">s_bootstrap</span></code></pre></div>
<pre><code>Mean Difference            0.05            0.95 
     -0.3113333      -0.4313667      -0.1833000 </code></pre>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Procedure</th>
<th align="right">Compares…</th>
<th align="right">Point Estimate</th>
<th align="right">90% CI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">Pooled t</td>
<td align="right">Means</td>
<td align="right">0.311</td>
<td align="right">(0.191, 0.432)</td>
</tr>
<tr class="even">
<td align="right">Welch t</td>
<td align="right">Means</td>
<td align="right">0.311</td>
<td align="right">(0.191, 0.432)</td>
</tr>
<tr class="odd">
<td align="right">Bootstrap</td>
<td align="right">Means</td>
<td align="right">0.311</td>
<td align="right">(0.183, 0.431)</td>
</tr>
<tr class="even">
<td align="right">Wilcoxon rank sum</td>
<td align="right">Pseudo-Medians</td>
<td align="right">0.3</td>
<td align="right">(0.2, 0.4)</td>
</tr>
</tbody>
</table></div>
<p>What conclusions can we draw in this setting?</p>
</div>
</div>
<div id="categorizing-the-outcome-and-comparing-rates" class="section level2" number="17.10">
<h2>
<span class="header-section-number">17.10</span> Categorizing the Outcome and Comparing Rates<a class="anchor" aria-label="anchor" href="#categorizing-the-outcome-and-comparing-rates"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose we were interested in comparing the percentage of patients in each arm of the trial (Ibuprofen vs. Placebo) that showed an improvement in their temperature (<code>temp_drop</code> &gt; 0). To build the cross-tabulation of interest, we could create a new variable, called <code>dropped</code> which indicates whether the subject’s temperature dropped, and then use <code>tabyl</code>.</p>
<div class="sourceCode" id="cb675"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">&lt;-</span> <span class="va">sepsis</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dropped <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">temp_drop</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"Drop"</span>, <span class="st">"No Drop"</span><span class="op">)</span><span class="op">)</span>

<span class="va">sepsis</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">treat</span>, <span class="va">dropped</span><span class="op">)</span></code></pre></div>
<pre><code>     treat Drop No Drop
 Ibuprofen  107      43
   Placebo   80      70</code></pre>
<p>Our primary interest is in comparing the percentage of Ibuprofen patients whose temperature dropped to the percentage of Placebo patients whose temperature dropped.</p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">treat</span>, <span class="va">dropped</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span>denom <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_ns.html">adorn_ns</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"front"</span><span class="op">)</span></code></pre></div>
<pre><code>     treat        Drop     No Drop
 Ibuprofen 107 (71.3%)  43 (28.7%)
   Placebo  80 (53.3%)  70 (46.7%)
     Total 187 (62.3%) 113 (37.7%)</code></pre>
</div>
<div id="estimating-the-difference-in-proportions" class="section level2" number="17.11">
<h2>
<span class="header-section-number">17.11</span> Estimating the Difference in Proportions<a class="anchor" aria-label="anchor" href="#estimating-the-difference-in-proportions"><i class="fas fa-link"></i></a>
</h2>
<p>In our sample, 71.3% of the Ibuprofen subjects, and 53.3% of the Placebo subjects, experienced a drop in temperature. So our <em>point estimate</em> of the difference in percentages would be 18.0 percentage points, but we will usually set this instead in terms of proportions, so that the difference is 0.180.</p>
<p>Now, we’ll find a confidence interval for that difference, which we can do in several ways, including the <code>twoby2</code> function in the <code>Epi</code> package.</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sepsis</span> <span class="op">%$%</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">treat</span>, <span class="va">dropped</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">Epi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Epi/man/twoby2.html">twoby2</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></code></pre></div>
<pre><code>2 by 2 table analysis: 
------------------------------------------------------ 
Outcome   : Drop 
Comparing : Ibuprofen vs. Placebo 

          Drop No Drop    P(Drop) 90% conf. interval
Ibuprofen  107      43     0.7133    0.6490   0.7701
Placebo     80      70     0.5333    0.4661   0.5993

                                   90% conf. interval
             Relative Risk: 1.3375    1.1492   1.5567
         Sample Odds Ratio: 2.1773    1.4583   3.2509
Conditional MLE Odds Ratio: 2.1716    1.4177   3.3437
    Probability difference: 0.1800    0.0881   0.2677

             Exact P-value: 0.0019 
        Asymptotic P-value: 0.0014 
------------------------------------------------------</code></pre>
<p>While there is a lot of additional output here, we’ll look for now just at the Probability difference row, where we see the point estimate (0.180) and the 90% confidence interval estimate for the difference in proportions (0.088, 0.268) comparing Ibuprofen vs. Placebo for the outcome of Dropping in Temperature.</p>
<p>More on estimation of the difference in population proportions will be found later.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></div>
<div class="next"><a href="comparing-means-with-paired-samples.html"><span class="header-section-number">18</span> Comparing Means with Paired Samples</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-ibuprofen-in-sepsis-randomized-clinical-trial"><span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial</a></li>
<li>
<a class="nav-link" href="#comparing-two-groups"><span class="header-section-number">17.1</span> Comparing Two Groups</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#model-based-comparisons-and-anovaregression"><span class="header-section-number">17.1.1</span> Model-Based Comparisons and ANOVA/Regression</a></li></ul>
</li>
<li>
<a class="nav-link" href="#key-questions-for-comparing-with-independent-samples"><span class="header-section-number">17.2</span> Key Questions for Comparing with Independent Samples</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-is-the-population-under-study"><span class="header-section-number">17.2.1</span> What is the population under study?</a></li>
<li><a class="nav-link" href="#what-is-the-sample-is-it-representative-of-the-population"><span class="header-section-number">17.2.2</span> What is the sample? Is it representative of the population?</a></li>
<li><a class="nav-link" href="#who-are-the-subjects-individuals-within-the-sample"><span class="header-section-number">17.2.3</span> Who are the subjects / individuals within the sample?</a></li>
<li><a class="nav-link" href="#what-data-are-available-on-each-individual"><span class="header-section-number">17.2.4</span> What data are available on each individual?</a></li>
<li><a class="nav-link" href="#rct-caveats"><span class="header-section-number">17.2.5</span> RCT Caveats</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exploratory-data-analysis"><span class="header-section-number">17.3</span> Exploratory Data Analysis</a></li>
<li><a class="nav-link" href="#estimating-the-difference-in-population-means"><span class="header-section-number">17.4</span> Estimating the Difference in Population Means</a></li>
<li>
<a class="nav-link" href="#t-based-ci-for-population-mean1---mean2-difference"><span class="header-section-number">17.5</span> t-based CI for population mean1 - mean2 difference</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-pooled-t-procedure"><span class="header-section-number">17.5.1</span> The Pooled t procedure</a></li>
<li><a class="nav-link" href="#using-linear-regression-to-obtain-a-pooled-t-confidence-interval"><span class="header-section-number">17.5.2</span> Using linear regression to obtain a pooled t confidence interval</a></li>
<li><a class="nav-link" href="#the-welch-t-procedure"><span class="header-section-number">17.5.3</span> The Welch t procedure</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wilcoxon-mann-whitney-rank-sum-ci"><span class="header-section-number">17.6</span> Wilcoxon-Mann-Whitney “Rank Sum” CI</a></li>
<li>
<a class="nav-link" href="#bootstrapping-a-more-robust-approach"><span class="header-section-number">17.7</span> Bootstrapping: A More Robust Approach</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#bootstrap-ci-for-the-sepsis-study"><span class="header-section-number">17.7.1</span> Bootstrap CI for the Sepsis study</a></li></ul>
</li>
<li><a class="nav-link" href="#summary-specifying-a-two-sample-study-design"><span class="header-section-number">17.8</span> Summary: Specifying A Two-Sample Study Design</a></li>
<li>
<a class="nav-link" href="#results-for-the-sepsis-study"><span class="header-section-number">17.9</span> Results for the sepsis study</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#sepsis-estimation-results"><span class="header-section-number">17.9.1</span> Sepsis Estimation Results</a></li></ul>
</li>
<li><a class="nav-link" href="#categorizing-the-outcome-and-comparing-rates"><span class="header-section-number">17.10</span> Categorizing the Outcome and Comparing Rates</a></li>
<li><a class="nav-link" href="#estimating-the-difference-in-proportions"><span class="header-section-number">17.11</span> Estimating the Difference in Proportions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/THOMASELOVE/431-notes/blob/master/17_IbuprofeninSepsisRCT.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/THOMASELOVE/431-notes/edit/master/17_IbuprofeninSepsisRCT.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</strong>" was written by Thomas E. Love. It was last built on 2021-10-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
