<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 25 Analysis of Variance | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
<meta name="author" content="Thomas E. Love">
<meta name="description" content="Recall the National Youth Fitness Survey, which we explored a small piece of in some detail earlier in these notes. We’ll look at a different part of the same survey here - specifically the 280...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 25 Analysis of Variance | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta property="og:type" content="book">
<meta property="og:url" content="https://thomaselove.github.io/431-notes/analysis-of-variance.html">
<meta property="og:description" content="Recall the National Youth Fitness Survey, which we explored a small piece of in some detail earlier in these notes. We’ll look at a different part of the same survey here - specifically the 280...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 25 Analysis of Variance | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta name="twitter:description" content="Recall the National Youth Fitness Survey, which we explored a small piece of in some detail earlier in these notes. We’ll look at a different part of the same survey here - specifically the 280...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Working with These Notes</a></li>
<li><a class="" href="data-science.html"><span class="header-section-number">1</span> Data Science</a></li>
<li class="book-part">Part A. Exploring Data</li>
<li><a class="" href="the-palmer-penguins.html"><span class="header-section-number">2</span> The Palmer Penguins</a></li>
<li><a class="" href="nhanes1.html"><span class="header-section-number">3</span> NHANES: A First Look</a></li>
<li><a class="" href="data-structures-variable-types-sampling-nhanes.html"><span class="header-section-number">4</span> Data Structures, Variable Types &amp; Sampling NHANES</a></li>
<li><a class="" href="visualizing-nhanes-data.html"><span class="header-section-number">5</span> Visualizing NHANES Data</a></li>
<li><a class="" href="summarizing_quantities.html"><span class="header-section-number">6</span> Summarizing Quantities</a></li>
<li><a class="" href="summarizing-categories.html"><span class="header-section-number">7</span> Summarizing Categories</a></li>
<li><a class="" href="miss.html"><span class="header-section-number">8</span> Missing Data and Single Imputation</a></li>
<li><a class="" href="NYFS-Study.html"><span class="header-section-number">9</span> National Youth Fitness Survey</a></li>
<li><a class="" href="assessing-normality.html"><span class="header-section-number">10</span> Assessing Normality</a></li>
<li><a class="" href="straight-line-models.html"><span class="header-section-number">11</span> Straight Line Models</a></li>
<li><a class="" href="linearizing-transformations.html"><span class="header-section-number">12</span> Linearizing Transformations</a></li>
<li><a class="" href="studying-crab-claws-crabs.html"><span class="header-section-number">13</span> Studying Crab Claws (crabs)</a></li>
<li><a class="" href="Hydrate-Study.html"><span class="header-section-number">14</span> Dehydration Recovery</a></li>
<li><a class="" href="WCGS-Study.html"><span class="header-section-number">15</span> The WCGS</a></li>
<li class="book-part">Part B. Comparing Summaries</li>
<li><a class="" href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></li>
<li><a class="" href="the-ibuprofen-in-sepsis-randomized-clinical-trial.html"><span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial</a></li>
<li><a class="" href="comparing-means-with-paired-samples.html"><span class="header-section-number">18</span> Comparing Means with Paired Samples</a></li>
<li><a class="" href="hypothesis-testing-what-is-it-good-for.html"><span class="header-section-number">19</span> Hypothesis Testing: What is it good for?</a></li>
<li><a class="" href="two-examples-comparing-means.html"><span class="header-section-number">20</span> Two Examples Comparing Means</a></li>
<li><a class="" href="estimating-a-population-proportion.html"><span class="header-section-number">21</span> Estimating a Population Proportion</a></li>
<li><a class="" href="comparing-proportions-with-two-independent-samples.html"><span class="header-section-number">22</span> Comparing Proportions with Two Independent Samples</a></li>
<li><a class="" href="power-and-proportions.html"><span class="header-section-number">23</span> Power and Proportions</a></li>
<li><a class="" href="larger-contingency-tables.html"><span class="header-section-number">24</span> Larger Contingency Tables</a></li>
<li><a class="active" href="analysis-of-variance.html"><span class="header-section-number">25</span> Analysis of Variance</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="some-r-tips.html">Some R Tips</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/THOMASELOVE/431-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analysis-of-variance" class="section level1" number="25">
<h1>
<span class="header-section-number">25</span> Analysis of Variance<a class="anchor" aria-label="anchor" href="#analysis-of-variance"><i class="fas fa-link"></i></a>
</h1>
<p>Recall the National Youth Fitness Survey, which we explored a small piece of in some detail earlier in these notes. We’ll look at a different part of the same survey here - specifically the 280 children whose data are captured in the <code>nyfs2</code> file.</p>
<div class="sourceCode" id="cb897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/nyfs2.csv"</span>,
                  show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">nyfs2</span></code></pre></div>
<pre><code># A tibble: 280 x 21
   subject.id sex    age.exam race.eth   english income.cat3
        &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;      
 1      73228 Male          4 5 Other o~       1 Low (below~
 2      72393 Male          4 2 Non-His~       1 Low (below~
 3      73303 Male          3 2 Non-His~       1 Low (below~
 4      72786 Male          5 1 Non-His~       1 Low (below~
 5      73048 Male          3 2 Non-His~       1 Low (below~
 6      72556 Female        4 2 Non-His~       1 Low (below~
 7      72580 Female        5 2 Non-His~       1 Low (below~
 8      72532 Female        4 4 Other H~       0 Low (below~
 9      73012 Male          4 1 Non-His~       1 Low (below~
10      72099 Male          6 1 Non-His~       1 Low (below~
# ... with 270 more rows, and 15 more variables:
#   income.detail &lt;chr&gt;, inc.to.pov &lt;dbl&gt;, weight.kg &lt;dbl&gt;,
#   height.cm &lt;dbl&gt;, bmi &lt;dbl&gt;, bmi.group &lt;dbl&gt;,
#   bmi.cat &lt;chr&gt;, arm.length &lt;dbl&gt;, arm.circ &lt;dbl&gt;,
#   waist.circ &lt;dbl&gt;, calf.circ &lt;dbl&gt;, calf.skinfold &lt;dbl&gt;,
#   triceps.skinfold &lt;dbl&gt;, subscap.skinfold &lt;dbl&gt;,
#   GMQ &lt;dbl&gt;</code></pre>
<div id="comparing-gross-motor-quotient-scores-by-income-level-3-categories" class="section level2" number="25.1">
<h2>
<span class="header-section-number">25.1</span> Comparing Gross Motor Quotient Scores by Income Level (3 Categories)<a class="anchor" aria-label="anchor" href="#comparing-gross-motor-quotient-scores-by-income-level-3-categories"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2a</span> <span class="op">&lt;-</span> <span class="va">nyfs2</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">subject.id</span>, <span class="va">income.cat3</span>, <span class="va">GMQ</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">subject.id</span><span class="op">)</span></code></pre></div>
<p>In this first analysis, we’ll compare the population mean on the Gross Motor Quotient evaluation of these kids across three groups defined by income level. Higher values of this GMQ measure indicate improved levels of gross motor development, both in terms of locomotor and object control. See <a href="https://wwwn.cdc.gov/Nchs/Nnyfs/Y_GMX.htm" class="uri">https://wwwn.cdc.gov/Nchs/Nnyfs/Y_GMX.htm</a> for more details.</p>
<div class="sourceCode" id="cb900"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2a</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income.cat3</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">mean</a></span><span class="op">(</span><span class="va">GMQ</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">median</a></span><span class="op">(</span><span class="va">GMQ</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  income.cat3            n `mean(GMQ)` `median(GMQ)`
  &lt;chr&gt;              &lt;int&gt;       &lt;dbl&gt;         &lt;dbl&gt;
1 High (65K or more)    92        95.7            97
2 Low (below 25K)       98        97.0            97
3 Middle (25 - 64K)     90        95.4            94</code></pre>
<p>Uh, oh. We should rearrange those income categories to match a natural order from low to high.</p>
<div class="sourceCode" id="cb902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2a</span><span class="op">$</span><span class="va">income.cat3</span> <span class="op">&lt;-</span> 
    <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">nyfs2a</span><span class="op">$</span><span class="va">income.cat3</span>,
                         <span class="st">"Low (below 25K)"</span>,
                         <span class="st">"Middle (25 - 64K)"</span>,
                         <span class="st">"High (65K or more)"</span><span class="op">)</span></code></pre></div>
<p>When working with three independent samples, I use graphs analogous to those we built for two independent samples.</p>
<div class="sourceCode" id="cb903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income.cat3</span>, y <span class="op">=</span> <span class="va">GMQ</span>, fill <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GMQ Scores for 280 Children in NNYFS"</span>,
       y <span class="op">=</span> <span class="st">"GMQ Score, in points"</span>, x <span class="op">=</span> <span class="st">"Income Category"</span><span class="op">)</span></code></pre></div>
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use
`guides(&lt;scale&gt; = "none")` instead.</code></pre>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/boxplot_nyfs2a-1.png" width="672"></div>
<p>In addition to this comparison boxplot, we might consider faceted plots, like these histograms.</p>
<div class="sourceCode" id="cb905"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GMQ</span>, fill <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">income.cat3</span><span class="op">)</span></code></pre></div>
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use
`guides(&lt;scale&gt; = "none")` instead.</code></pre>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/histograms_nyfs2a-1.png" width="672"></div>
<p>Or, if we want to ignore the (modest) sample size differences, we might consider density functions, perhaps through a ridgeline plot.</p>
<div class="sourceCode" id="cb907"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GMQ</span>, y <span class="op">=</span> <span class="va">income.cat3</span>, fill <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GMQ Score (in points) by Income Group"</span>,
         x <span class="op">=</span> <span class="st">"GMQ Score"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/theme_ridges.html">theme_ridges</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use
`guides(&lt;scale&gt; = "none")` instead.</code></pre>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/nyfs2a_ridgelineplot-1.png" width="672"></div>
<div class="sourceCode" id="cb909"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span><span class="va">nyfs2a</span><span class="op">$</span><span class="va">GMQ</span>, <span class="va">nyfs2a</span><span class="op">$</span><span class="va">income.cat3</span>, <span class="fu">mosaic</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">)</span></code></pre></div>
<pre><code>nyfs2a$income.cat3: Low (below 25K)
 min Q1 median  Q3 max     mean       sd  n missing
  55 91     97 106 130 97.03061 14.79444 98       0
--------------------------------------------- 
nyfs2a$income.cat3: Middle (25 - 64K)
 min Q1 median  Q3 max     mean       sd  n missing
  67 85     94 106 136 95.36667 14.15123 90       0
--------------------------------------------- 
nyfs2a$income.cat3: High (65K or more)
 min Q1 median  Q3 max     mean       sd  n missing
  64 85     97 103 145 95.72826 14.49525 92       0</code></pre>
</div>
<div id="alternative-procedures-for-comparing-more-than-two-means" class="section level2" number="25.2">
<h2>
<span class="header-section-number">25.2</span> Alternative Procedures for Comparing More Than Two Means<a class="anchor" aria-label="anchor" href="#alternative-procedures-for-comparing-more-than-two-means"><i class="fas fa-link"></i></a>
</h2>
<p>Now, if we only had two independent samples, we’d be choosing between a pooled t test, a Welch t test, and a non-parametric procedure like the Wilcoxon-Mann-Whitney rank sum test, or even perhaps a bootstrap alternative.</p>
<p>In the case of more than two independent samples, we have methods analogous to the Welch test, and the rank sum test, and even the bootstrap, but we’re going to be far more likely to select the <strong>analysis of variance</strong> (ANOVA) or an equivalent regression-based approach. These are the extensions of the pooled t test. Unless the sample outcome data are very clearly not Normally distributed, and no transformation is available which makes them appear approximately Normal in all of the groups we are comparing, we will stick with ANOVA.</p>
<div id="extending-the-welch-test-to-2-independent-samples" class="section level3" number="25.2.1">
<h3>
<span class="header-section-number">25.2.1</span> Extending the Welch Test to &gt; 2 Independent Samples<a class="anchor" aria-label="anchor" href="#extending-the-welch-test-to-2-independent-samples"><i class="fas fa-link"></i></a>
</h3>
<p>It is possible to extend the Welch two-sample t test (not assuming equal population variances) into an analogous one-factor analysis for comparing population means based on independent samples from more than two groups.</p>
<p>If we want to compare the population mean GMQ levels across those three income groups without assuming equal population variances, <code>oneway.test</code> is up to the task. The hypotheses being tested here are:</p>
<ul>
<li>H0: All three means are the same vs.</li>
<li>HA: At least one of the population means is different than the others.</li>
</ul>
<div class="sourceCode" id="cb911"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span></code></pre></div>
<pre><code>
    One-way analysis of means (not assuming equal
    variances)

data:  GMQ and income.cat3
F = 0.3416, num df = 2.00, denom df = 184.41, p-value
= 0.7111</code></pre>
<p>We get a p value, but this isn’t much help, though, because we don’t have any measure of effect size, nor do we have any confidence intervals. Like the analogous Welch t test, this approach allows us to forego the assumption of equal population variances in each of the three income groups, but it still requires us to assume that the populations are Normally distributed.</p>
<p>That said, most of the time when we have more than two levels of the factor of interest, we won’t bother worrying about the equal population variance assumption, and will just use the one-factor ANOVA approach (with pooled variances) described below, to make the comparisons of interest.</p>
</div>
<div id="extending-the-rank-sum-test-to-2-independent-samples" class="section level3" number="25.2.2">
<h3>
<span class="header-section-number">25.2.2</span> Extending the Rank Sum Test to &gt; 2 Independent Samples<a class="anchor" aria-label="anchor" href="#extending-the-rank-sum-test-to-2-independent-samples"><i class="fas fa-link"></i></a>
</h3>
<p>It is also possible to extend the Wilcoxon-Mann-Whitney two-sample test into an analogous one-factor analysis called the <strong>Kruskal-Wallis test</strong> for comparing population measures of location based on independent samples from more than two groups.</p>
<p>If we want to compare the centers of the distributions of population GMQ score across our three income groups without assuming Normality, we can use <code>kruskal.test</code>.</p>
<p>The hypotheses being tested here are still as before, but for a measure of location other than the population mean</p>
<div class="sourceCode" id="cb913"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span></code></pre></div>
<pre><code>
    Kruskal-Wallis rank sum test

data:  GMQ by income.cat3
Kruskal-Wallis chi-squared = 2.3202, df = 2, p-value
= 0.3135</code></pre>
<p>Again, note that this isn’t much help, though, because we don’t have any measure of effect size, nor do we have any confidence intervals.</p>
<p>That said, most of the time when we have more than two levels of the factor of interest, we won’t bother worrying about potential violations of the Normality assumption unless they are glaring, and will just use the usual one-factor ANOVA approach (with pooled variances) described below, to make the comparisons of interest.</p>
</div>
<div id="can-we-use-the-bootstrap-to-compare-more-than-two-means" class="section level3" number="25.2.3">
<h3>
<span class="header-section-number">25.2.3</span> Can we use the bootstrap to compare more than two means?<a class="anchor" aria-label="anchor" href="#can-we-use-the-bootstrap-to-compare-more-than-two-means"><i class="fas fa-link"></i></a>
</h3>
<p>Sure. There are both ANOVA and ANCOVA analogues using the bootstrap, and in fact, there are power calculations based on the bootstrap, too. If you want to see some example code, look at <a href="https://sammancuso.com/2017/11/01/model-based-bootstrapped-anova-and-ancova/" class="uri">https://sammancuso.com/2017/11/01/model-based-bootstrapped-anova-and-ancova/</a></p>
</div>
</div>
<div id="the-analysis-of-variance" class="section level2" number="25.3">
<h2>
<span class="header-section-number">25.3</span> The Analysis of Variance<a class="anchor" aria-label="anchor" href="#the-analysis-of-variance"><i class="fas fa-link"></i></a>
</h2>
<p>Extending the two-sample t test (assuming equal population variances) into a comparison of more than two samples uses the <strong>analysis of variance</strong> or ANOVA.</p>
<p>This is an analysis of a continuous outcome variable on the basis of a single categorical factor, in fact, it’s often called one-factor ANOVA or one-way ANOVA to indicate that the outcome is being split up into the groups defined by a single factor.</p>
<p>The null hypothesis is that the population means are all the same, and the alternative is that this is not the case. When there are just two groups, then this boils down to an F test that is equivalent to the Pooled t test.</p>
<div id="the-oneway.test-approach" class="section level3" number="25.3.1">
<h3>
<span class="header-section-number">25.3.1</span> The <code>oneway.test</code> approach<a class="anchor" aria-label="anchor" href="#the-oneway.test-approach"><i class="fas fa-link"></i></a>
</h3>
<p>R will produce some elements of a one-factor ANOVA using the <code>oneway.test</code> command:</p>
<div class="sourceCode" id="cb915"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span>, var.equal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>
    One-way analysis of means

data:  GMQ and income.cat3
F = 0.34687, num df = 2, denom df = 277, p-value =
0.7072</code></pre>
<p>This isn’t the full analysis, though, which would require a more complete ANOVA table. There are two equivalent approaches to obtaining the full ANOVA table when comparing a series of 2 or more population means based on independent samples.</p>
</div>
<div id="using-the-aov-approach-and-the-summary-function" class="section level3" number="25.3.2">
<h3>
<span class="header-section-number">25.3.2</span> Using the <code>aov</code> approach and the <code>summary</code> function<a class="anchor" aria-label="anchor" href="#using-the-aov-approach-and-the-summary-function"><i class="fas fa-link"></i></a>
</h3>
<p>Here’s one possible ANOVA table, which doesn’t require directly fitting a linear model.</p>
<div class="sourceCode" id="cb917"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146   72.85   0.347  0.707
Residuals   277  58174  210.01               </code></pre>
</div>
<div id="using-the-anova-function-after-fitting-a-linear-model" class="section level3" number="25.3.3">
<h3>
<span class="header-section-number">25.3.3</span> Using the <code>anova</code> function after fitting a linear model<a class="anchor" aria-label="anchor" href="#using-the-anova-function-after-fitting-a-linear-model"><i class="fas fa-link"></i></a>
</h3>
<p>An equivalent way to get identical results in a slightly different format runs the linear model behind the ANOVA approach directly.</p>
<div class="sourceCode" id="cb919"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
<div id="interpreting-the-anova-table" class="section level2" number="25.4">
<h2>
<span class="header-section-number">25.4</span> Interpreting the ANOVA Table<a class="anchor" aria-label="anchor" href="#interpreting-the-anova-table"><i class="fas fa-link"></i></a>
</h2>
<div id="what-are-we-testing" class="section level3" number="25.4.1">
<h3>
<span class="header-section-number">25.4.1</span> What are we Testing?<a class="anchor" aria-label="anchor" href="#what-are-we-testing"><i class="fas fa-link"></i></a>
</h3>
<p>The null hypothesis for the ANOVA table is that the population means of the outcome across the various levels of the factor of interest are all the same, against a two-sided alternative hypothesis that the level-specific population means are not all the same.</p>
<p>Specifically, if we have a grouping factor with <em>k</em> levels, then we are testing:</p>
<ul>
<li>H0: All k population means are the same.</li>
<li>HA: At least one of the population means is different from the others.</li>
</ul>
</div>
<div id="elements-of-the-anova-table" class="section level3" number="25.4.2">
<h3>
<span class="header-section-number">25.4.2</span> Elements of the ANOVA Table<a class="anchor" aria-label="anchor" href="#elements-of-the-anova-table"><i class="fas fa-link"></i></a>
</h3>
<p>The ANOVA table breaks down the variation in the outcome explained by the k levels of the factor of interest, and the variation in the outcome which remains (the Residual, or Error).</p>
<p>Specifically, the elements of the ANOVA table are:</p>
<ol style="list-style-type: decimal">
<li>the degrees of freedom (labeled Df) for the factor of interest and for the Residuals</li>
<li>the sums of squares (labeled Sum Sq) for the factor of interest and for the Residuals</li>
<li>the mean square (labeled Mean Sq) for the factor of interest and for the Residuals</li>
<li>the ANOVA F test statistic (labeled F value), which is used to generate</li>
<li>the <em>p</em> value for the comparison assessed by the ANOVA model, labeled Pr(&gt;F)</li>
</ol>
</div>
<div id="the-degrees-of-freedom" class="section level3" number="25.4.3">
<h3>
<span class="header-section-number">25.4.3</span> The Degrees of Freedom<a class="anchor" aria-label="anchor" href="#the-degrees-of-freedom"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb921"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
<ul>
<li>The <strong>degrees of freedom</strong> attributable to the factor of interest (here, Income category) is the number of levels of the factor minus 1. Here, we have three Income categories (levels), so df(income.cat3) = 2.</li>
<li>The total degrees of freedom are the number of observations (across all levels of the factor) minus 1. We have 280 GMQ scores in the <code>nyfs2a</code> data, so the df(Total) must be 279, although the Total row isn’t shown by R in its output.</li>
<li>The Residual degrees of freedom are the Total df - Factor df. So, here, that’s 279 - 2 = 277.</li>
</ul>
</div>
<div id="the-sums-of-squares" class="section level3" number="25.4.4">
<h3>
<span class="header-section-number">25.4.4</span> The Sums of Squares<a class="anchor" aria-label="anchor" href="#the-sums-of-squares"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb923"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
<ul>
<li>The sum of squares (often abbreviated SS or Sum Sq) represents variation explained.</li>
<li>The factor SS is the sum across all levels of the factor of the sample size for the level multiplied by the squared difference between the level mean and the overall mean across all levels. Here, SS(<code>income.cat3</code>) = 146</li>
<li>The total SS is the sum across all observations of the square of the difference between the individual values and the overall mean. Here, that is 146 + 58174 = 58320</li>
<li>Residual SS = Total SS - Factor SS.</li>
<li>Also of interest is a calculation called <span class="math inline">\(\eta^2\)</span>, (“eta-squared”), which is equivalent to <span class="math inline">\(R^2\)</span> in a linear model.
<ul>
<li>SS(Factor) / SS(Total) = the proportion of variation in our outcome (here, GMQ) explained by the variation between groups (here, income groups)</li>
<li>In our case, <span class="math inline">\(\eta^2\)</span> = 146 / (146 + 58174) = 146 / 58320 = 0.0025</li>
<li>So, Income Category alone accounts for about 0.25% of the variation in GMQ levels observed in these data.</li>
</ul>
</li>
</ul>
</div>
<div id="the-mean-square" class="section level3" number="25.4.5">
<h3>
<span class="header-section-number">25.4.5</span> The Mean Square<a class="anchor" aria-label="anchor" href="#the-mean-square"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb925"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
<ul>
<li>The Mean Square is the Sum of Squares divided by the degrees of freedom, so MS(Factor) = SS(Factor)/df(Factor).</li>
<li>In our case, MS(<code>income.cat3</code>) = SS(<code>income.cat3</code>)/df(<code>income.cat3</code>) = 146 / 2 = 72.848 (notice that R maintains more decimal places than it shows for these calculations) and</li>
<li>MS(Residuals) = SS(Residuals) / df(Residuals) = 58174 / 277 = 210.014.
<ul>
<li>MS(Residuals) or MS(Error) is an estimate of the residual variance which corresponds to <span class="math inline">\(\sigma^2\)</span> in the underlying linear model for the outcome of interest, here <code>GMQ</code>.</li>
</ul>
</li>
</ul>
</div>
<div id="the-f-test-statistic-and-p-value" class="section level3" number="25.4.6">
<h3>
<span class="header-section-number">25.4.6</span> The F Test Statistic and <em>p</em> Value<a class="anchor" aria-label="anchor" href="#the-f-test-statistic-and-p-value"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
<ul>
<li>The ANOVA F test is obtained by calculating MS(Factor) / MS(Residuals). So in our case, F = 72.848 / 210.014 = 0.3469</li>
<li>The F test statistic is then compared to a specific F distribution to obtain a <em>p</em> value, which is shown here to be 0.7072</li>
<li>Specifically, the observed F test statistic is compared to an F distribution with numerator df = Factor df, and denominator df = Residual df to obtain the <em>p</em> value.
<ul>
<li>Here, we have SS(Factor) = 146 (approximately), and df(Factor) = 2, leaving MS(Factor) = 72.848</li>
<li>We have SS(Residual) = 58174, and df(Residual) = 277, leaving MS(Residual) = 210.014</li>
<li>MS(Factor) / MS(Residual) = F value = 0.3469, which, when compared to an F distribution with 2 and 277 degrees of freedom, yields a <em>p</em> value of 0.7072</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="the-residual-standard-error" class="section level2" number="25.5">
<h2>
<span class="header-section-number">25.5</span> The Residual Standard Error<a class="anchor" aria-label="anchor" href="#the-residual-standard-error"><i class="fas fa-link"></i></a>
</h2>
<p>The residual standard error is simply the square root of the variance estimate MS(Residual). Here, MS(Residual) = 210.014, so the Residual standard error = 14.49 points.</p>
</div>
<div id="the-proportion-of-variance-explained-by-the-factor" class="section level2" number="25.6">
<h2>
<span class="header-section-number">25.6</span> The Proportion of Variance Explained by the Factor<a class="anchor" aria-label="anchor" href="#the-proportion-of-variance-explained-by-the-factor"><i class="fas fa-link"></i></a>
</h2>
<p>We will often summarize the proportion of the variation explained by the factor. The summary statistic is called eta-squared (<span class="math inline">\(\eta^2\)</span>), and is equivalent to the <span class="math inline">\(R^2\)</span> value we have seen previously in linear regression models.</p>
<p>Again, <span class="math inline">\(\eta^2\)</span> = SS(Factor) / SS(Total)</p>
<p>Here, we have
- SS(<code>income.cat3</code>) = 146 and SS(Residuals) = 58174, so SS(Total) = 58320
- Thus, <span class="math inline">\(\eta^2\)</span> = SS(Factor)/SS(Total) = 146/58320 = 0.0025</p>
<p>The income category accounts for 0.25% of the variation in GMQ levels: only a tiny fraction.</p>
</div>
<div id="the-regression-approach-to-compare-population-means-based-on-independent-samples" class="section level2" number="25.7">
<h2>
<span class="header-section-number">25.7</span> The Regression Approach to Compare Population Means based on Independent Samples<a class="anchor" aria-label="anchor" href="#the-regression-approach-to-compare-population-means-based-on-independent-samples"><i class="fas fa-link"></i></a>
</h2>
<p>This approach is equivalent to the ANOVA approach, and thus also (when there are just two samples to compare) to the pooled-variance t test. We run a linear regression model to predict the outcome (here, <code>GMQ</code>) on the basis of the categorical factor with three levels (here, <code>income.cat3</code>)</p>
<div class="sourceCode" id="cb929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data<span class="op">=</span><span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = GMQ ~ income.cat3, data = nyfs2a)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.031  -9.031  -0.031   8.969  49.272 

Coefficients:
                              Estimate Std. Error t value
(Intercept)                     97.031      1.464  66.282
income.cat3Middle (25 - 64K)    -1.664      2.116  -0.786
income.cat3High (65K or more)   -1.302      2.104  -0.619
                              Pr(&gt;|t|)    
(Intercept)                     &lt;2e-16 ***
income.cat3Middle (25 - 64K)     0.432    
income.cat3High (65K or more)    0.536    
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.49 on 277 degrees of freedom
Multiple R-squared:  0.002498,  Adjusted R-squared:  -0.004704 
F-statistic: 0.3469 on 2 and 277 DF,  p-value: 0.7072</code></pre>
<div id="interpreting-the-regression-output" class="section level3" number="25.7.1">
<h3>
<span class="header-section-number">25.7.1</span> Interpreting the Regression Output<a class="anchor" aria-label="anchor" href="#interpreting-the-regression-output"><i class="fas fa-link"></i></a>
</h3>
<p>This output tells us many things, but for now, we’ll focus just on the coefficients output, which tells us that:</p>
<ul>
<li>the point estimate for the population mean GMQ score across “Low” income subjects is 97.03</li>
<li>the point estimate (sample mean difference) for the difference in population mean GMQ level between the “Middle” and “Low” income subjects is -1.66 (in words, the Middle income kids have lower GMQ scores than the Low income kids by 1.66 points on average.)</li>
<li>the point estimate (sample mean difference) for the difference in population mean GMQ level between the “High” and “Low” income subjects is -1.30 (in words, the High income kids have lower GMQ scores than the Low income kids by 1.30 points on average.)</li>
</ul>
<p>Of course, we knew all of this already from a summary of the sample means.</p>
<div class="sourceCode" id="cb931"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2a</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income.cat3</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">mean</a></span><span class="op">(</span><span class="va">GMQ</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  income.cat3            n `mean(GMQ)`
  &lt;fct&gt;              &lt;int&gt;       &lt;dbl&gt;
1 Low (below 25K)       98        97.0
2 Middle (25 - 64K)     90        95.4
3 High (65K or more)    92        95.7</code></pre>
<p>The model for predicting GMQ is based on two binary (1/0) indicator variables, specifically, we have:</p>
<ul>
<li>Estimated GMQ = 97.03 - 1.66 x [1 if Middle income or 0 if not] - 1.30 x [1 if High income or 0 if not]</li>
</ul>
<p>The coefficients section also provides a standard error and t statistic and two-sided <em>p</em> value for each coefficient.</p>
</div>
<div id="the-full-anova-table" class="section level3" number="25.7.2">
<h3>
<span class="header-section-number">25.7.2</span> The Full ANOVA Table<a class="anchor" aria-label="anchor" href="#the-full-anova-table"><i class="fas fa-link"></i></a>
</h3>
<p>To see the full ANOVA table corresponding to any linear regression model, we run…</p>
<div class="sourceCode" id="cb933"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data<span class="op">=</span><span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: GMQ
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
<div id="anova-assumptions" class="section level3" number="25.7.3">
<h3>
<span class="header-section-number">25.7.3</span> ANOVA Assumptions<a class="anchor" aria-label="anchor" href="#anova-assumptions"><i class="fas fa-link"></i></a>
</h3>
<p>The assumptions behind analysis of variance are the same as those behind a linear model. Of specific interest are:</p>
<ul>
<li>The samples obtained from each group are independent.</li>
<li>Ideally, the samples from each group are a random sample from the population described by that group.</li>
<li>In the population, the variance of the outcome in each group is equal. (This is less of an issue if our study involves a balanced design.)</li>
<li>In the population, we have Normal distributions of the outcome in each group.</li>
</ul>
<p>Happily, the F test is fairly robust to violations of the Normality assumption.</p>
</div>
</div>
<div id="equivalent-approach-to-get-anova-results" class="section level2" number="25.8">
<h2>
<span class="header-section-number">25.8</span> Equivalent approach to get ANOVA Results<a class="anchor" aria-label="anchor" href="#equivalent-approach-to-get-anova-results"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
income.cat3   2    146   72.85   0.347  0.707
Residuals   277  58174  210.01               </code></pre>
<p>So which of the pairs of means are driving the differences we see?</p>
</div>
<div id="the-problem-of-multiple-comparisons" class="section level2" number="25.9">
<h2>
<span class="header-section-number">25.9</span> The Problem of Multiple Comparisons<a class="anchor" aria-label="anchor" href="#the-problem-of-multiple-comparisons"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Suppose we compare High to Low, using a test with <span class="math inline">\(\alpha\)</span> = 0.05</li>
<li>Then we compare Middle to Low on the same outcome, also using <span class="math inline">\(\alpha\)</span> = 0.05</li>
<li>Then we compare High to Middle, also with <span class="math inline">\(\alpha\)</span> = 0.05</li>
</ol>
<p>What is our overall <span class="math inline">\(\alpha\)</span> level across these three comparisons?</p>
<ul>
<li>It could be as bad as 0.05 + 0.05 + 0.05, or 0.15.</li>
<li>Rather than our nominal 95% confidence, we have something as low as 85% confidence across this set of simultaneous comparisons.</li>
</ul>
<div id="the-bonferroni-solution" class="section level3" number="25.9.1">
<h3>
<span class="header-section-number">25.9.1</span> The Bonferroni solution<a class="anchor" aria-label="anchor" href="#the-bonferroni-solution"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Suppose we compare High to Low, using a test with <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
<li>Then we compare Middle to Low on the same outcome, also using <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
<li>Then we compare High to Middle, also with <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
</ol>
<p>Then across these three comparisons, our overall <span class="math inline">\(\alpha\)</span> can be (at worst)</p>
<ul>
<li>0.05/3 + 0.05/3 + 0.05/3 = 0.05</li>
<li>So by changing our nominal confidence level from 95% to 98.333% in each comparison, we wind up with at least 95% confidence across this set of simultaneous comparisons.</li>
<li>This is a conservative (worst case) approach.</li>
</ul>
<p>Goal: Simultaneous comparisons of White vs AA, AA vs Other and White vs Other</p>
<div class="sourceCode" id="cb937"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">nyfs2a</span><span class="op">$</span><span class="va">GMQ</span>, <span class="va">nyfs2a</span><span class="op">$</span><span class="va">income.cat3</span>, p.adjust<span class="op">=</span><span class="st">"bonferroni"</span><span class="op">)</span></code></pre></div>
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  nyfs2a$GMQ and nyfs2a$income.cat3 

                   Low (below 25K) Middle (25 - 64K)
Middle (25 - 64K)  1               -                
High (65K or more) 1               1                

P value adjustment method: bonferroni </code></pre>
<p>These <em>p</em> values are very large.</p>
</div>
<div id="pairwise-comparisons-using-tukeys-hsd-method" class="section level3" number="25.9.2">
<h3>
<span class="header-section-number">25.9.2</span> Pairwise Comparisons using Tukey’s HSD Method<a class="anchor" aria-label="anchor" href="#pairwise-comparisons-using-tukeys-hsd-method"><i class="fas fa-link"></i></a>
</h3>
<p>Goal: Simultaneous (less conservative) confidence intervals and <em>p</em> values for our three pairwise comparisons (High vs. Low, High vs. Middle, Middle vs. Low)</p>
<div class="sourceCode" id="cb939"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = GMQ ~ income.cat3, data = nyfs2a)

$income.cat3
                                           diff       lwr
Middle (25 - 64K)-Low (below 25K)    -1.6639456 -6.649518
High (65K or more)-Low (below 25K)   -1.3023514 -6.259595
High (65K or more)-Middle (25 - 64K)  0.3615942 -4.701208
                                          upr     p adj
Middle (25 - 64K)-Low (below 25K)    3.321627 0.7116745
High (65K or more)-Low (below 25K)   3.654892 0.8098084
High (65K or more)-Middle (25 - 64K) 5.424396 0.9845073</code></pre>
</div>
<div id="plotting-the-tukey-hsd-results" class="section level3" number="25.9.3">
<h3>
<span class="header-section-number">25.9.3</span> Plotting the Tukey HSD results<a class="anchor" aria-label="anchor" href="#plotting-the-tukey-hsd-results"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb941"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/hsd_plot_nyfs2a-1.png" width="672"></div>
<p>Note that the default positioning of the y axis in the plot of Tukey HSD results can be problematic. If we have longer names, in particular, for the levels of our factor, R will leave out some of the labels. We can alleviate that problem either by using the <code>fct_recode</code> function in the <code>forcats</code> package to rename the factor levels, or we can use the following code to reconfigure the margins of the plot.</p>
<div class="sourceCode" id="cb942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mar.default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="co"># save default plotting margins</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">mar.default</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GMQ</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
<div class="sourceCode" id="cb943"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">mar.default</span><span class="op">)</span> <span class="co"># return to normal plotting margins</span></code></pre></div>
</div>
</div>
<div id="what-if-we-consider-another-outcome-bmi" class="section level2" number="25.10">
<h2>
<span class="header-section-number">25.10</span> What if we consider another outcome, BMI?<a class="anchor" aria-label="anchor" href="#what-if-we-consider-another-outcome-bmi"><i class="fas fa-link"></i></a>
</h2>
<p>We’ll look at the full data set in <code>nyfs2</code> now, so we can look at BMI as a function of income.</p>
<div class="sourceCode" id="cb944"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2</span><span class="op">$</span><span class="va">income.cat3</span> <span class="op">&lt;-</span> 
    <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">nyfs2</span><span class="op">$</span><span class="va">income.cat3</span>,
                         <span class="st">"Low (below 25K)"</span>,
                         <span class="st">"Middle (25 - 64K)"</span>,
                         <span class="st">"High (65K or more)"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bmi</span>, y <span class="op">=</span> <span class="va">income.cat3</span>, fill <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Body-Mass Index by Income Group"</span>,
         x <span class="op">=</span> <span class="st">"Body-Mass Index"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/theme_ridges.html">theme_ridges</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use
`guides(&lt;scale&gt; = "none")` instead.</code></pre>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="sourceCode" id="cb946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income.cat3</span>, y <span class="op">=</span> <span class="va">bmi</span>, fill <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">income.cat3</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"BMI for 280 Children in NNYFS"</span>,
       y <span class="op">=</span> <span class="st">"Body-Mass Index"</span>, x <span class="op">=</span> <span class="st">"Income Category"</span><span class="op">)</span></code></pre></div>
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use
`guides(&lt;scale&gt; = "none")` instead.</code></pre>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>Here are the descriptive numerical summaries:</p>
<div class="sourceCode" id="cb948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span></code></pre></div>
<pre><code>         income.cat3  min     Q1 median   Q3  max     mean
1    Low (below 25K) 13.8 15.500  16.50 17.9 25.2 16.98163
2  Middle (25 - 64K) 13.7 15.225  16.05 16.9 24.1 16.37111
3 High (65K or more) 13.8 15.300  15.85 17.2 21.8 16.27065
        sd  n missing
1 2.194574 98       0
2 1.898920 90       0
3 1.614395 92       0</code></pre>
<p>Here is the ANOVA table.</p>
<div class="sourceCode" id="cb950"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">income.cat3</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: bmi
             Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
income.cat3   2   28.32 14.1583  3.8252 0.02298 *
Residuals   277 1025.26  3.7013                  
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Let’s consider the Tukey HSD results. First, we’ll create a factor with shorter labels.</p>
<div class="sourceCode" id="cb952"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyfs2</span><span class="op">$</span><span class="va">inc.new</span> <span class="op">&lt;-</span> 
    <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">nyfs2</span><span class="op">$</span><span class="va">income.cat3</span>,
                        <span class="st">"Low"</span> <span class="op">=</span> <span class="st">"Low (below 25K)"</span>,
                        <span class="st">"Middle"</span> <span class="op">=</span> <span class="st">"Middle (25 - 64K)"</span>,
                        <span class="st">"High"</span> <span class="op">=</span> <span class="st">"High (65K or more)"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">inc.new</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="25_ANOVA_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<p>It appears that there is a detectable difference between the <code>bmi</code> means of the “Low” group and both the “High” and “Middle” group at the 90% confidence level, but no detectable difference between “Middle” and “High.” Details of those confidence intervals for those pairwise comparisons follow.</p>
<div class="sourceCode" id="cb953"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">inc.new</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span>,
                  conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></code></pre></div>
<pre><code>  Tukey multiple comparisons of means
    90% family-wise confidence level

Fit: aov(formula = bmi ~ inc.new, data = nyfs2)

$inc.new
                  diff        lwr         upr     p adj
Middle-Low  -0.6105215 -1.1893722 -0.03167084 0.0775491
High-Low    -0.7109805 -1.2865420 -0.13541892 0.0306639
High-Middle -0.1004589 -0.6882764  0.48735849 0.9339289</code></pre>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="larger-contingency-tables.html"><span class="header-section-number">24</span> Larger Contingency Tables</a></div>
<div class="next"><a href="some-r-tips.html">Some R Tips</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analysis-of-variance"><span class="header-section-number">25</span> Analysis of Variance</a></li>
<li><a class="nav-link" href="#comparing-gross-motor-quotient-scores-by-income-level-3-categories"><span class="header-section-number">25.1</span> Comparing Gross Motor Quotient Scores by Income Level (3 Categories)</a></li>
<li>
<a class="nav-link" href="#alternative-procedures-for-comparing-more-than-two-means"><span class="header-section-number">25.2</span> Alternative Procedures for Comparing More Than Two Means</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#extending-the-welch-test-to-2-independent-samples"><span class="header-section-number">25.2.1</span> Extending the Welch Test to &gt; 2 Independent Samples</a></li>
<li><a class="nav-link" href="#extending-the-rank-sum-test-to-2-independent-samples"><span class="header-section-number">25.2.2</span> Extending the Rank Sum Test to &gt; 2 Independent Samples</a></li>
<li><a class="nav-link" href="#can-we-use-the-bootstrap-to-compare-more-than-two-means"><span class="header-section-number">25.2.3</span> Can we use the bootstrap to compare more than two means?</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#the-analysis-of-variance"><span class="header-section-number">25.3</span> The Analysis of Variance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-oneway.test-approach"><span class="header-section-number">25.3.1</span> The oneway.test approach</a></li>
<li><a class="nav-link" href="#using-the-aov-approach-and-the-summary-function"><span class="header-section-number">25.3.2</span> Using the aov approach and the summary function</a></li>
<li><a class="nav-link" href="#using-the-anova-function-after-fitting-a-linear-model"><span class="header-section-number">25.3.3</span> Using the anova function after fitting a linear model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#interpreting-the-anova-table"><span class="header-section-number">25.4</span> Interpreting the ANOVA Table</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-are-we-testing"><span class="header-section-number">25.4.1</span> What are we Testing?</a></li>
<li><a class="nav-link" href="#elements-of-the-anova-table"><span class="header-section-number">25.4.2</span> Elements of the ANOVA Table</a></li>
<li><a class="nav-link" href="#the-degrees-of-freedom"><span class="header-section-number">25.4.3</span> The Degrees of Freedom</a></li>
<li><a class="nav-link" href="#the-sums-of-squares"><span class="header-section-number">25.4.4</span> The Sums of Squares</a></li>
<li><a class="nav-link" href="#the-mean-square"><span class="header-section-number">25.4.5</span> The Mean Square</a></li>
<li><a class="nav-link" href="#the-f-test-statistic-and-p-value"><span class="header-section-number">25.4.6</span> The F Test Statistic and p Value</a></li>
</ul>
</li>
<li><a class="nav-link" href="#the-residual-standard-error"><span class="header-section-number">25.5</span> The Residual Standard Error</a></li>
<li><a class="nav-link" href="#the-proportion-of-variance-explained-by-the-factor"><span class="header-section-number">25.6</span> The Proportion of Variance Explained by the Factor</a></li>
<li>
<a class="nav-link" href="#the-regression-approach-to-compare-population-means-based-on-independent-samples"><span class="header-section-number">25.7</span> The Regression Approach to Compare Population Means based on Independent Samples</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#interpreting-the-regression-output"><span class="header-section-number">25.7.1</span> Interpreting the Regression Output</a></li>
<li><a class="nav-link" href="#the-full-anova-table"><span class="header-section-number">25.7.2</span> The Full ANOVA Table</a></li>
<li><a class="nav-link" href="#anova-assumptions"><span class="header-section-number">25.7.3</span> ANOVA Assumptions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#equivalent-approach-to-get-anova-results"><span class="header-section-number">25.8</span> Equivalent approach to get ANOVA Results</a></li>
<li>
<a class="nav-link" href="#the-problem-of-multiple-comparisons"><span class="header-section-number">25.9</span> The Problem of Multiple Comparisons</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-bonferroni-solution"><span class="header-section-number">25.9.1</span> The Bonferroni solution</a></li>
<li><a class="nav-link" href="#pairwise-comparisons-using-tukeys-hsd-method"><span class="header-section-number">25.9.2</span> Pairwise Comparisons using Tukey’s HSD Method</a></li>
<li><a class="nav-link" href="#plotting-the-tukey-hsd-results"><span class="header-section-number">25.9.3</span> Plotting the Tukey HSD results</a></li>
</ul>
</li>
<li><a class="nav-link" href="#what-if-we-consider-another-outcome-bmi"><span class="header-section-number">25.10</span> What if we consider another outcome, BMI?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/THOMASELOVE/431-notes/blob/master/25_ANOVA.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/THOMASELOVE/431-notes/edit/master/25_ANOVA.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</strong>" was written by Thomas E. Love. It was last built on 2021-10-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
