<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 15 The WCGS | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</title>
<meta name="author" content="Thomas E. Love">
<meta name="description" content="15.1 The Western Collaborative Group Study (wcgs) data set Vittinghoff et al.33 explore data from the Western Collaborative Group Study (WCGS) in great detail34. We’ll touch lightly on some key...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 15 The WCGS | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta property="og:type" content="book">
<meta property="og:url" content="https://thomaselove.github.io/431-notes/WCGS-Study.html">
<meta property="og:description" content="15.1 The Western Collaborative Group Study (wcgs) data set Vittinghoff et al.33 explore data from the Western Collaborative Group Study (WCGS) in great detail34. We’ll touch lightly on some key...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 15 The WCGS | Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431">
<meta name="twitter:description" content="15.1 The Western Collaborative Group Study (wcgs) data set Vittinghoff et al.33 explore data from the Western Collaborative Group Study (WCGS) in great detail34. We’ll touch lightly on some key...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Working with These Notes</a></li>
<li><a class="" href="data-science.html"><span class="header-section-number">1</span> Data Science</a></li>
<li class="book-part">Part A. Exploring Data</li>
<li><a class="" href="the-palmer-penguins.html"><span class="header-section-number">2</span> The Palmer Penguins</a></li>
<li><a class="" href="nhanes1.html"><span class="header-section-number">3</span> NHANES: A First Look</a></li>
<li><a class="" href="data-structures-variable-types-sampling-nhanes.html"><span class="header-section-number">4</span> Data Structures, Variable Types &amp; Sampling NHANES</a></li>
<li><a class="" href="visualizing-nhanes-data.html"><span class="header-section-number">5</span> Visualizing NHANES Data</a></li>
<li><a class="" href="summarizing_quantities.html"><span class="header-section-number">6</span> Summarizing Quantities</a></li>
<li><a class="" href="summarizing-categories.html"><span class="header-section-number">7</span> Summarizing Categories</a></li>
<li><a class="" href="miss.html"><span class="header-section-number">8</span> Missing Data and Single Imputation</a></li>
<li><a class="" href="NYFS-Study.html"><span class="header-section-number">9</span> National Youth Fitness Survey</a></li>
<li><a class="" href="assessing-normality.html"><span class="header-section-number">10</span> Assessing Normality</a></li>
<li><a class="" href="straight-line-models.html"><span class="header-section-number">11</span> Straight Line Models</a></li>
<li><a class="" href="linearizing-transformations.html"><span class="header-section-number">12</span> Linearizing Transformations</a></li>
<li><a class="" href="studying-crab-claws-crabs.html"><span class="header-section-number">13</span> Studying Crab Claws (crabs)</a></li>
<li><a class="" href="Hydrate-Study.html"><span class="header-section-number">14</span> Dehydration Recovery</a></li>
<li><a class="active" href="WCGS-Study.html"><span class="header-section-number">15</span> The WCGS</a></li>
<li class="book-part">Part B. Comparing Summaries</li>
<li><a class="" href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></li>
<li><a class="" href="the-ibuprofen-in-sepsis-randomized-clinical-trial.html"><span class="header-section-number">17</span> The Ibuprofen in Sepsis Randomized Clinical Trial</a></li>
<li><a class="" href="comparing-means-with-paired-samples.html"><span class="header-section-number">18</span> Comparing Means with Paired Samples</a></li>
<li><a class="" href="hypothesis-testing-what-is-it-good-for.html"><span class="header-section-number">19</span> Hypothesis Testing: What is it good for?</a></li>
<li><a class="" href="two-examples-comparing-means.html"><span class="header-section-number">20</span> Two Examples Comparing Means</a></li>
<li><a class="" href="estimating-a-population-proportion.html"><span class="header-section-number">21</span> Estimating a Population Proportion</a></li>
<li><a class="" href="comparing-proportions-with-two-independent-samples.html"><span class="header-section-number">22</span> Comparing Proportions with Two Independent Samples</a></li>
<li><a class="" href="power-and-proportions.html"><span class="header-section-number">23</span> Power and Proportions</a></li>
<li><a class="" href="larger-contingency-tables.html"><span class="header-section-number">24</span> Larger Contingency Tables</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">25</span> Analysis of Variance</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="some-r-tips.html">Some R Tips</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/THOMASELOVE/431-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="WCGS-Study" class="section level1" number="15">
<h1>
<span class="header-section-number">15</span> The WCGS<a class="anchor" aria-label="anchor" href="#WCGS-Study"><i class="fas fa-link"></i></a>
</h1>
<div id="the-western-collaborative-group-study-wcgs-data-set" class="section level2" number="15.1">
<h2>
<span class="header-section-number">15.1</span> The Western Collaborative Group Study (<code>wcgs</code>) data set<a class="anchor" aria-label="anchor" href="#the-western-collaborative-group-study-wcgs-data-set"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation"><a href="references.html#ref-Vittinghoff" role="doc-biblioref">Vittinghoff et al.</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references.html#ref-Vittinghoff" role="doc-biblioref"&gt;&lt;em&gt;Regression Methods in Biostatistics&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;'><sup>33</sup></a></span> explore data from the Western Collaborative Group Study (WCGS) in great detail<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;For more on the WCGS, you might look at &lt;a href="http://www.epi.umn.edu/cvdepi/study-synopsis/western-collaborative-group-study/" class="uri"&gt;http://www.epi.umn.edu/cvdepi/study-synopsis/western-collaborative-group-study/&lt;/a&gt;&lt;/p&gt;'><sup>34</sup></a>. We’ll touch lightly on some key issues in this Chapter.</p>
<blockquote>
<p>The Western Collaborative Group Study (WCGS) was designed to test the hypothesis that the so-called Type A behavior pattern (TABP) - “characterized particularly by excessive drive, aggressiveness, and ambition, frequently in association with a relatively greater preoccupation with competitive activity, vocational deadlines, and similar pressures” - is a cause of coronary heart disease (CHD). Two additional goals, developed later in the study, were (1) to investigate the comparability of formulas developed in WCGS and in the Framingham Study (FS) for prediction of CHD risk, and (2) to determine how addition of TABP to an existing multivariate prediction formula affects ability to select subjects for intervention programs.</p>
</blockquote>
<p>The study enrolled over 3,000 men ages 39-59 who were employed in San Francisco or Los Angeles, during 1960 and 1961.</p>
<div class="sourceCode" id="cb524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/wcgs.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/naniar/man/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="va">as_factor</span><span class="op">)</span><span class="op">)</span>

<span class="va">wcgs</span></code></pre></div>
<pre><code># A tibble: 3,154 x 22
      id   age agec  height weight lnwght wghtcat   bmi
   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;
 1  2343    50 46-50     67    200   5.30 170-200  31.3
 2  3656    51 51-55     73    192   5.26 170-200  25.3
 3  3526    59 56-60     70    200   5.30 170-200  28.7
 4 22057    51 51-55     69    150   5.01 140-170  22.1
 5 12927    44 41-45     71    160   5.08 140-170  22.3
 6 16029    47 46-50     64    158   5.06 140-170  27.1
 7  3894    40 35-40     70    162   5.09 140-170  23.2
 8 11389    41 41-45     70    160   5.08 140-170  23.0
 9 12681    50 46-50     71    195   5.27 170-200  27.2
10 10005    43 41-45     68    187   5.23 170-200  28.4
# ... with 3,144 more rows, and 14 more variables:
#   sbp &lt;dbl&gt;, lnsbp &lt;dbl&gt;, dbp &lt;dbl&gt;, chol &lt;dbl&gt;,
#   behpat &lt;fct&gt;, dibpat &lt;fct&gt;, smoke &lt;fct&gt;, ncigs &lt;dbl&gt;,
#   arcus &lt;dbl&gt;, chd69 &lt;fct&gt;, typchd69 &lt;dbl&gt;,
#   time169 &lt;dbl&gt;, t1 &lt;dbl&gt;, uni &lt;dbl&gt;</code></pre>
<p>Here, we have 3154 rows (subjects) and 22 columns (variables). After importing the data and creating a tibble with <code>read_csv</code>, I used <code>mutate(across(where(is.character), as_factor)</code> to convert all variables containing character data into factors.</p>
<div id="structure-of-wcgs" class="section level3" number="15.1.1">
<h3>
<span class="header-section-number">15.1.1</span> Structure of <code>wcgs</code><a class="anchor" aria-label="anchor" href="#structure-of-wcgs"><i class="fas fa-link"></i></a>
</h3>
<p>We can specify the (sometimes terrible) variable names, through the <code>names</code> function, or we can add other elements of the structure, so that we can identify elements of particular interest.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">wcgs</span><span class="op">)</span></code></pre></div>
<pre><code>spec_tbl_df [3,154 x 22] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ id      : num [1:3154] 2343 3656 3526 22057 12927 ...
 $ age     : num [1:3154] 50 51 59 51 44 47 40 41 50 43 ...
 $ agec    : Factor w/ 5 levels "46-50","51-55",..: 1 2 3 2 4 1 5 4 1 4 ...
 $ height  : num [1:3154] 67 73 70 69 71 64 70 70 71 68 ...
 $ weight  : num [1:3154] 200 192 200 150 160 158 162 160 195 187 ...
 $ lnwght  : num [1:3154] 5.3 5.26 5.3 5.01 5.08 ...
 $ wghtcat : Factor w/ 4 levels "170-200","140-170",..: 1 1 1 2 2 2 2 2 1 1 ...
 $ bmi     : num [1:3154] 31.3 25.3 28.7 22.1 22.3 ...
 $ sbp     : num [1:3154] 132 120 158 126 126 116 122 130 112 120 ...
 $ lnsbp   : num [1:3154] 4.88 4.79 5.06 4.84 4.84 ...
 $ dbp     : num [1:3154] 90 74 94 80 80 76 78 84 70 80 ...
 $ chol    : num [1:3154] 249 194 258 173 214 206 190 212 130 233 ...
 $ behpat  : Factor w/ 4 levels "A1","A2","B3",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ dibpat  : Factor w/ 2 levels "Type A","Type B": 1 1 1 1 1 1 1 1 1 1 ...
 $ smoke   : Factor w/ 2 levels "Yes","No": 1 1 2 2 2 1 2 1 2 1 ...
 $ ncigs   : num [1:3154] 25 25 0 0 0 80 0 25 0 25 ...
 $ arcus   : num [1:3154] 1 0 1 1 0 0 0 0 1 0 ...
 $ chd69   : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ typchd69: num [1:3154] 0 0 0 0 0 0 0 0 0 0 ...
 $ time169 : num [1:3154] 1367 2991 2960 3069 3081 ...
 $ t1      : num [1:3154] -1.63 -4.06 0.64 1.12 2.43 ...
 $ uni     : num [1:3154] 0.486 0.186 0.728 0.624 0.379 ...
 - attr(*, "spec")=
  .. cols(
  ..   id = col_double(),
  ..   age = col_double(),
  ..   agec = col_character(),
  ..   height = col_double(),
  ..   weight = col_double(),
  ..   lnwght = col_double(),
  ..   wghtcat = col_character(),
  ..   bmi = col_double(),
  ..   sbp = col_double(),
  ..   lnsbp = col_double(),
  ..   dbp = col_double(),
  ..   chol = col_double(),
  ..   behpat = col_character(),
  ..   dibpat = col_character(),
  ..   smoke = col_character(),
  ..   ncigs = col_double(),
  ..   arcus = col_double(),
  ..   chd69 = col_character(),
  ..   typchd69 = col_double(),
  ..   time169 = col_double(),
  ..   t1 = col_double(),
  ..   uni = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div id="codebook-for-wcgs" class="section level3" number="15.1.2">
<h3>
<span class="header-section-number">15.1.2</span> Codebook for <code>wcgs</code><a class="anchor" aria-label="anchor" href="#codebook-for-wcgs"><i class="fas fa-link"></i></a>
</h3>
<p>This table was lovingly hand-crafted, and involved a lot of typing. We’ll look for better ways in 432.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Name</th>
<th align="center">Stored As</th>
<th align="center">Type</th>
<th>Details (units, levels, etc.)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><code>id</code></td>
<td align="center">integer</td>
<td align="center">(nominal)</td>
<td>ID #, nominal and uninteresting</td>
</tr>
<tr class="even">
<td align="right"><code>age</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>age, in years - no decimal places</td>
</tr>
<tr class="odd">
<td align="right"><code>agec</code></td>
<td align="center">factor (5)</td>
<td align="center">(ordinal)</td>
<td>age: 35-40, 41-45, 46-50, 51-55, 56-60</td>
</tr>
<tr class="even">
<td align="right"><code>height</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>height, in inches</td>
</tr>
<tr class="odd">
<td align="right"><code>weight</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>weight, in pounds</td>
</tr>
<tr class="even">
<td align="right"><code>lnwght</code></td>
<td align="center">number</td>
<td align="center">quantitative</td>
<td>natural logarithm of weight</td>
</tr>
<tr class="odd">
<td align="right"><code>wghtcat</code></td>
<td align="center">factor (4)</td>
<td align="center">(ordinal)</td>
<td>wt: &lt; 140, 140-170, 170-200, &gt; 200</td>
</tr>
<tr class="even">
<td align="right"><code>bmi</code></td>
<td align="center">number</td>
<td align="center">quantitative</td>
<td>body-mass index:</td>
</tr>
<tr class="odd">
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td>703 * weight in lb / (height in in)<sup>2</sup>
</td>
</tr>
<tr class="even">
<td align="right"><code>sbp</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>systolic blood pressure, in mm Hg</td>
</tr>
<tr class="odd">
<td align="right"><code>lnsbp</code></td>
<td align="center">number</td>
<td align="center">quantitative</td>
<td>natural logarithm of sbp</td>
</tr>
<tr class="even">
<td align="right"><code>dbp</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>diastolic blood pressure, mm Hg</td>
</tr>
<tr class="odd">
<td align="right"><code>chol</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>total cholesterol, mg/dL</td>
</tr>
<tr class="even">
<td align="right"><code>behpat</code></td>
<td align="center">factor (4)</td>
<td align="center">(nominal)</td>
<td>behavioral pattern: A1, A2, B3 or B4</td>
</tr>
<tr class="odd">
<td align="right"><code>dibpat</code></td>
<td align="center">factor (2)</td>
<td align="center">(binary)</td>
<td>behavioral pattern: A or B</td>
</tr>
<tr class="even">
<td align="right"><code>smoke</code></td>
<td align="center">factor (2)</td>
<td align="center">(binary)</td>
<td>cigarette smoker: Yes or No</td>
</tr>
<tr class="odd">
<td align="right"><code>ncigs</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>number of cigarettes smoked per day</td>
</tr>
<tr class="even">
<td align="right"><code>arcus</code></td>
<td align="center">integer</td>
<td align="center">(nominal)</td>
<td>arcus senilis present (1) or absent (0)</td>
</tr>
<tr class="odd">
<td align="right"><code>chd69</code></td>
<td align="center">factor (2)</td>
<td align="center">(binary)</td>
<td>CHD event: Yes or No</td>
</tr>
<tr class="even">
<td align="right"><code>typchd69</code></td>
<td align="center">integer</td>
<td align="center">(4 levels)</td>
<td>event: 0 = no CHD, 1 = MI or SD,</td>
</tr>
<tr class="odd">
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td>2 = silent MI, 3 = angina</td>
</tr>
<tr class="even">
<td align="right"><code>time169</code></td>
<td align="center">integer</td>
<td align="center">quantitative</td>
<td>follow-up time in days</td>
</tr>
<tr class="odd">
<td align="right"><code>t1</code></td>
<td align="center">number</td>
<td align="center">quantitative</td>
<td>heavy-tailed (random draws)</td>
</tr>
<tr class="even">
<td align="right"><code>uni</code></td>
<td align="center">number</td>
<td align="center">quantitative</td>
<td>light-tailed (random draws)</td>
</tr>
</tbody>
</table></div>
</div>
<div id="quick-summary" class="section level3" number="15.1.3">
<h3>
<span class="header-section-number">15.1.3</span> Quick Summary<a class="anchor" aria-label="anchor" href="#quick-summary"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wcgs</span><span class="op">)</span></code></pre></div>
<pre><code>       id             age           agec     
 Min.   : 2001   Min.   :39.00   46-50: 750  
 1st Qu.: 3741   1st Qu.:42.00   51-55: 528  
 Median :11406   Median :45.00   56-60: 242  
 Mean   :10478   Mean   :46.28   41-45:1091  
 3rd Qu.:13115   3rd Qu.:50.00   35-40: 543  
 Max.   :22101   Max.   :59.00               
                                             
     height          weight        lnwght     
 Min.   :60.00   Min.   : 78   Min.   :4.357  
 1st Qu.:68.00   1st Qu.:155   1st Qu.:5.043  
 Median :70.00   Median :170   Median :5.136  
 Mean   :69.78   Mean   :170   Mean   :5.128  
 3rd Qu.:72.00   3rd Qu.:182   3rd Qu.:5.204  
 Max.   :78.00   Max.   :320   Max.   :5.768  
                                              
    wghtcat          bmi             sbp       
 170-200:1171   Min.   :11.19   Min.   : 98.0  
 140-170:1538   1st Qu.:22.96   1st Qu.:120.0  
 &gt; 200  : 213   Median :24.39   Median :126.0  
 &lt; 140  : 232   Mean   :24.52   Mean   :128.6  
                3rd Qu.:25.84   3rd Qu.:136.0  
                Max.   :38.95   Max.   :230.0  
                                               
     lnsbp            dbp              chol       behpat   
 Min.   :4.585   Min.   : 58.00   Min.   :103.0   A1: 264  
 1st Qu.:4.787   1st Qu.: 76.00   1st Qu.:197.2   A2:1325  
 Median :4.836   Median : 80.00   Median :223.0   B3:1216  
 Mean   :4.850   Mean   : 82.02   Mean   :226.4   B4: 349  
 3rd Qu.:4.913   3rd Qu.: 86.00   3rd Qu.:253.0            
 Max.   :5.438   Max.   :150.00   Max.   :645.0            
                                  NA's   :12               
    dibpat     smoke          ncigs          arcus       
 Type A:1589   Yes:1502   Min.   : 0.0   Min.   :0.0000  
 Type B:1565   No :1652   1st Qu.: 0.0   1st Qu.:0.0000  
                          Median : 0.0   Median :0.0000  
                          Mean   :11.6   Mean   :0.2985  
                          3rd Qu.:20.0   3rd Qu.:1.0000  
                          Max.   :99.0   Max.   :1.0000  
                                         NA's   :2       
 chd69         typchd69         time169    
 No :2897   Min.   :0.0000   Min.   :  18  
 Yes: 257   1st Qu.:0.0000   1st Qu.:2842  
            Median :0.0000   Median :2942  
            Mean   :0.1363   Mean   :2684  
            3rd Qu.:0.0000   3rd Qu.:3037  
            Max.   :3.0000   Max.   :3430  
                                           
       t1                 uni           
 Min.   :-47.43147   Min.   :0.0007097  
 1st Qu.: -1.00337   1st Qu.:0.2573755  
 Median :  0.00748   Median :0.5157779  
 Mean   : -0.03336   Mean   :0.5052159  
 3rd Qu.:  0.97575   3rd Qu.:0.7559902  
 Max.   : 47.01623   Max.   :0.9994496  
 NA's   :39                             </code></pre>
<p>For a more detailed description, we might consider <code><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">Hmisc::describe</a></code>, <code><a href="https://rdrr.io/pkg/psych/man/describe.html">psych::describe</a></code>, <code><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">mosaic::favstats</a></code>, etc.</p>
</div>
</div>
<div id="are-the-sbps-normally-distributed" class="section level2" number="15.2">
<h2>
<span class="header-section-number">15.2</span> Are the SBPs Normally Distributed?<a class="anchor" aria-label="anchor" href="#are-the-sbps-normally-distributed"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the question of whether the distribution of the systolic blood pressure results is well-approximated by the Normal.</p>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sbp</span>, data <span class="op">=</span> <span class="va">wcgs</span><span class="op">)</span>
<span class="va">bin_w</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># specify binwidth</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="va">bin_w</span>, 
                   fill <span class="op">=</span> <span class="st">"orchid"</span>, 
                   col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>
        fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">mean</span>, 
                                sd <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span> <span class="op">*</span> 
            <span class="va">res</span><span class="op">$</span><span class="va">n</span> <span class="op">*</span> <span class="va">bin_w</span>,
        col <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Systolic BP for `wcgs` subjects"</span>,
     x <span class="op">=</span> <span class="st">"Systolic BP (mm Hg)"</span>, y <span class="op">=</span> <span class="st">""</span>,
     caption <span class="op">=</span> <span class="st">"Superimposed Normal model"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk30-1.png" width="672"></div>
<p>Since the data contain both <code>sbp</code> and <code>lnsbp</code> (its natural logarithm), let’s compare them. Note that in preparing the graph, we’ll need to change the location for the text annotation.</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="op">~</span> <span class="va">lnsbp</span>, data <span class="op">=</span> <span class="va">wcgs</span><span class="op">)</span>
<span class="va">bin_w</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># specify binwidth</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lnsbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="va">bin_w</span>, 
                   fill <span class="op">=</span> <span class="st">"orange"</span>, 
                   col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>
        fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">mean</span>, 
                                sd <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span> <span class="op">*</span> 
            <span class="va">res</span><span class="op">$</span><span class="va">n</span> <span class="op">*</span> <span class="va">bin_w</span>,
        col <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ln(Systolic BP) for `wcgs` subjects"</span>,
     x <span class="op">=</span> <span class="st">"ln(Systolic BP)"</span>, y <span class="op">=</span> <span class="st">""</span>,
     caption <span class="op">=</span> <span class="st">"Superimposed Normal model"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk40-1.png" width="672"></div>
<p>We can also look at Normal Q-Q plots, for instance…</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orchid"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Ordered SBP"</span>, title <span class="op">=</span> <span class="st">"sbp in wcgs"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">lnsbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Ordered ln(SBP)"</span>, title <span class="op">=</span> <span class="st">"ln(sbp) in wcgs"</span><span class="op">)</span>

<span class="co">## next step requires library(patchwork)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> 
    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Normal Q-Q plots of SBP and ln(SBP) in wcgs"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk50-1.png" width="672"></div>
<p>There’s at best a small improvement from <code>sbp</code> to <code>lnsbp</code> in terms of approximation by a Normal distribution.</p>
</div>
<div id="identifying-and-describing-sbp-outliers" class="section level2" number="15.3">
<h2>
<span class="header-section-number">15.3</span> Identifying and Describing SBP outliers<a class="anchor" aria-label="anchor" href="#identifying-and-describing-sbp-outliers"><i class="fas fa-link"></i></a>
</h2>
<p>It looks like there’s an outlier (or a series of them) in the SBP data.</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">sbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"royalblue"</span>, 
                 outlier.color <span class="op">=</span> <span class="st">"royalblue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot with Violin of SBP in `wcgs` data"</span>,
         y <span class="op">=</span> <span class="st">"Systolic Blood Pressure (mm Hg)"</span>, 
         x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk60-1.png" width="672"></div>
<div class="sourceCode" id="cb534"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%$%</span> <span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">describe</a></span><span class="op">(</span><span class="va">sbp</span><span class="op">)</span></code></pre></div>
<pre><code>sbp 
       n  missing distinct     Info     Mean      Gmd 
    3154        0       62    0.996    128.6    16.25 
     .05      .10      .25      .50      .75      .90 
     110      112      120      126      136      148 
     .95 
     156 

lowest :  98 100 102 104 106, highest: 200 208 210 212 230</code></pre>
<p>The maximum value here is 230, and is clearly the most extreme value in the data set. One way to gauge this is to describe that observation’s <strong>Z score</strong>, the number of standard deviations away from the mean that the observation falls. Here, the maximum value, 230 is 6.71 standard deviations above the mean, and thus has a Z score of 6.7.</p>
<p>A negative Z score would indicate a point below the mean, while a positive Z score indicates, as we’ve seen, a point above the mean. The minimum systolic blood pressure, 98 is 2.03 standard deviations <em>below</em> the mean, so it has a Z score of -2.</p>
<p>Recall that the Empirical Rule suggests that if a variable follows a Normal distribution, it would have approximately 95% of its observations falling inside a Z score of (-2, 2), and 99.74% falling inside a Z score range of (-3, 3). Do the systolic blood pressures appear Normally distributed?</p>
</div>
<div id="does-weight-category-relate-to-sbp" class="section level2" number="15.4">
<h2>
<span class="header-section-number">15.4</span> Does Weight Category Relate to SBP?<a class="anchor" aria-label="anchor" href="#does-weight-category-relate-to-sbp"><i class="fas fa-link"></i></a>
</h2>
<p>The data are collected into four groups based on the subject’s weight (in pounds).</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wghtcat</span>, y <span class="op">=</span> <span class="va">sbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">wghtcat</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.3</span>, notch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot of Systolic BP by Weight Category in WCGS"</span>, 
         x <span class="op">=</span> <span class="st">"Weight Category"</span>, y <span class="op">=</span> <span class="st">"Systolic Blood Pressure"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk80-1.png" width="672"></div>
</div>
<div id="re-leveling-a-factor" class="section level2" number="15.5">
<h2>
<span class="header-section-number">15.5</span> Re-Leveling a Factor<a class="anchor" aria-label="anchor" href="#re-leveling-a-factor"><i class="fas fa-link"></i></a>
</h2>
<p>Well, that’s not so good. We really want those weight categories (the <em>levels</em>) to be ordered more sensibly.</p>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">wghtcat</span><span class="op">)</span></code></pre></div>
<pre><code> wghtcat    n    percent
 170-200 1171 0.37127457
 140-170 1538 0.48763475
   &gt; 200  213 0.06753329
   &lt; 140  232 0.07355739</code></pre>
<p>Like all <em>factor</em> variables in R, the categories are specified as levels. We want to change the order of the levels in a new version of this factor variable so they make sense. There are multiple ways to do this, but I prefer the <code>fct_relevel</code> function from the <code>forcats</code> package (part of the tidyverse.) Which order is more appropriate?</p>
<p>I’ll add a new variable to the <code>wcgs</code> data called <code>weight_f</code> that relevels the <code>wghtcat</code> data.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">&lt;-</span> <span class="va">wcgs</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>weight_f <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">wghtcat</span>, <span class="st">"&lt; 140"</span>, <span class="st">"140-170"</span>, <span class="st">"170-200"</span>, <span class="st">"&gt; 200"</span><span class="op">)</span><span class="op">)</span>

<span class="va">wcgs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">weight_f</span><span class="op">)</span></code></pre></div>
<pre><code> weight_f    n    percent
    &lt; 140  232 0.07355739
  140-170 1538 0.48763475
  170-200 1171 0.37127457
    &gt; 200  213 0.06753329</code></pre>
<p>For more on the <code>forcats</code> package, check out <span class="citation"><a href="references.html#ref-R4DS" role="doc-biblioref">Grolemund and Wickham</a>,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references.html#ref-R4DS" role="doc-biblioref"&gt;&lt;em&gt;R for Data Science&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;'><sup>35</sup></a></span> especially the Section on Factors.</p>
<div id="sbp-by-weight-category" class="section level3" number="15.5.1">
<h3>
<span class="header-section-number">15.5.1</span> SBP by Weight Category<a class="anchor" aria-label="anchor" href="#sbp-by-weight-category"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight_f</span>, y <span class="op">=</span> <span class="va">sbp</span>, fill <span class="op">=</span> <span class="va">weight_f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Systolic Blood Pressure by Reordered Weight Category in WCGS"</span>, 
         x <span class="op">=</span> <span class="st">"Weight Category"</span>, y <span class="op">=</span> <span class="st">"Systolic Blood Pressure"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk110-1.png" width="672"></div>
<p>We might see some details well with a <strong>ridgeline plot</strong>, too.</p>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sbp</span>, y <span class="op">=</span> <span class="va">weight_f</span>, fill <span class="op">=</span> <span class="va">weight_f</span>, height <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SBP by Weight Category (wcgs)"</span>,
         x <span class="op">=</span> <span class="st">"Systolic Blood Pressure"</span>,
         y <span class="op">=</span> <span class="st">"Weight Category"</span><span class="op">)</span> </code></pre></div>
<pre><code>Picking joint bandwidth of 3.74</code></pre>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk120-1.png" width="672"></div>
<p>As the plots suggest, patients in the heavier groups generally had higher systolic blood pressures.</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">sbp</span> <span class="op">~</span> <span class="va">weight_f</span>, data <span class="op">=</span> <span class="va">wcgs</span><span class="op">)</span></code></pre></div>
<pre><code>  weight_f min  Q1 median  Q3 max     mean       sd    n
1    &lt; 140  98 112    120 130 196 123.1379 14.73394  232
2  140-170 100 118    124 134 192 126.2939 13.65294 1538
3  170-200 100 120    130 140 230 131.1136 15.57024 1171
4    &gt; 200 110 126    132 150 212 137.8685 16.75522  213
  missing
1       0
2       0
3       0
4       0</code></pre>
</div>
</div>
<div id="are-weight-and-sbp-linked" class="section level2" number="15.6">
<h2>
<span class="header-section-number">15.6</span> Are Weight and SBP Linked?<a class="anchor" aria-label="anchor" href="#are-weight-and-sbp-linked"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s build a scatter plot of SBP (Outcome) by Weight (Predictor), rather than breaking down into categories.</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">sbp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, shape<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"forestgreen"</span><span class="op">)</span> <span class="op">+</span> <span class="co">## default size = 2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="co">## add se=FALSE to hide conf. interval</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">loess</span>, se<span class="op">=</span><span class="cn">FALSE</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"SBP vs. Weight in 3,154 WCGS Subjects"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk140-1.png" width="672"></div>
<ul>
<li>The mass of the data is hidden from us - showing 3154 points in one plot can produce little more than a blur where there are lots of points on top of each other.</li>
<li>Here the least squares regression line (in red), and loess scatterplot smoother, (in blue) can help.</li>
</ul>
<p>The relationship between systolic blood pressure and weight appears to be very close to linear, but of course there is considerable scatter around that generally linear relationship. It turns out that the Pearson correlation of these two variables is 0.253.</p>
</div>
<div id="sbp-and-weight-by-arcus-senilis-groups" class="section level2" number="15.7">
<h2>
<span class="header-section-number">15.7</span> SBP and Weight by Arcus Senilis groups?<a class="anchor" aria-label="anchor" href="#sbp-and-weight-by-arcus-senilis-groups"><i class="fas fa-link"></i></a>
</h2>
<p>An issue of interest to us will be to assess whether the SBP-Weight relationship we see above is similar among subjects who have arcus senilis and those who do not.</p>
<blockquote>
<p>Arcus senilis is an old age syndrome where there is a white, grey, or blue opaque ring in the corneal margin (peripheral corneal opacity), or white ring in front of the periphery of the iris. It is present at birth but then fades; however, it is quite commonly present in the elderly. It can also appear earlier in life as a result of hypercholesterolemia.</p>
<p>Wikipedia article on Arcus Senilis, retrieved 2017-08-15</p>
</blockquote>
<p>Let’s start with a quick look at the <code>arcus</code> data.</p>
<div class="sourceCode" id="cb547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">arcus</span><span class="op">)</span></code></pre></div>
<pre><code> arcus    n      percent valid_percent
     0 2211 0.7010145847     0.7014594
     1  941 0.2983512999     0.2985406
    NA    2 0.0006341154            NA</code></pre>
<p>We have 2 missing values, so we probably want to do something about that before plotting the data, and we may also want to create a factor variable with more meaningful labels than 1 (which means yes, arcus senilis is present) and 0 (which means no, it isn’t.)</p>
<div class="sourceCode" id="cb549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">&lt;-</span> <span class="va">wcgs</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>arcus_f <span class="op">=</span> <span class="fu">fct_recode</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">arcus</span><span class="op">)</span>,
                                <span class="st">"Arcus senilis"</span> <span class="op">=</span> <span class="st">"1"</span>,
                                <span class="st">"No arcus senilis"</span> <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span>,
           arcus_f <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">arcus_f</span>, <span class="st">"Arcus senilis"</span><span class="op">)</span><span class="op">)</span>

<span class="va">wcgs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">arcus_f</span>, <span class="va">arcus</span><span class="op">)</span></code></pre></div>
<pre><code>          arcus_f    0   1 NA_
    Arcus senilis    0 941   0
 No arcus senilis 2211   0   0
             &lt;NA&gt;    0   0   2</code></pre>
<p>Let’s build a version of the <code>wcgs</code> data that eliminates all missing data in the variables of immediate interest, and then plot the SBP-weight relationship in groups of patients with and without arcus senilis.</p>
<div class="sourceCode" id="cb551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">arcus_f</span>, <span class="va">sbp</span>, <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">sbp</span>, group <span class="op">=</span> <span class="va">arcus_f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">loess</span>, se<span class="op">=</span><span class="cn">FALSE</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SBP vs. Weight by Arcus Senilis status"</span>,
         caption <span class="op">=</span> <span class="st">"3,152 Western Collaborative Group Study subjects with known arcus senilis status"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">arcus_f</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk170-1.png" width="672"></div>
</div>
<div id="linear-model-for-sbp-weight-relationship-subjects-without-arcus-senilis" class="section level2" number="15.8">
<h2>
<span class="header-section-number">15.8</span> Linear Model for SBP-Weight Relationship: subjects without Arcus Senilis<a class="anchor" aria-label="anchor" href="#linear-model-for-sbp-weight-relationship-subjects-without-arcus-senilis"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model.noarcus</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sbp</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="va">arcus</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model.noarcus</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">95.92</td>
<td align="right">2.56</td>
<td align="right">37.54</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0.19</td>
<td align="right">0.01</td>
<td align="right">12.77</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">model.noarcus</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">r.squared</span><span class="op">:</span><span class="va">p.value</span>, <span class="va">AIC</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">AIC</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.069</td>
<td align="right">0.068</td>
<td align="right">14.799</td>
<td align="right">162.959</td>
<td align="right">0</td>
<td align="right">18193.78</td>
</tr></tbody>
</table></div>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.noarcus</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = sbp ~ weight, data = filter(wcgs, arcus == 0))

Residuals:
    Min      1Q  Median      3Q     Max 
-29.011 -10.251  -2.447   7.553  99.848 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  95.9219     2.5552   37.54   &lt;2e-16 ***
weight        0.1902     0.0149   12.77   &lt;2e-16 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.8 on 2209 degrees of freedom
Multiple R-squared:  0.0687,    Adjusted R-squared:  0.06828 
F-statistic:   163 on 1 and 2209 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The linear model for the 2211 patients without Arcus Senilis has R-squared = 6.87%.</p>
<ul>
<li>The regression equation is 95.92 - 0.19 weight, for those patients without Arcus Senilis.</li>
</ul>
</div>
<div id="linear-model-for-sbp-weight-relationship-subjects-with-arcus-senilis" class="section level2" number="15.9">
<h2>
<span class="header-section-number">15.9</span> Linear Model for SBP-Weight Relationship: subjects with Arcus Senilis<a class="anchor" aria-label="anchor" href="#linear-model-for-sbp-weight-relationship-subjects-with-arcus-senilis"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model.witharcus</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sbp</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="va">arcus</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model.witharcus</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">101.88</td>
<td align="right">3.76</td>
<td align="right">27.13</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0.16</td>
<td align="right">0.02</td>
<td align="right">7.39</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">model.witharcus</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">r.squared</span><span class="op">:</span><span class="va">p.value</span>, <span class="va">AIC</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">AIC</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.055</td>
<td align="right">0.054</td>
<td align="right">14.192</td>
<td align="right">54.583</td>
<td align="right">0</td>
<td align="right">7666.828</td>
</tr></tbody>
</table></div>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.witharcus</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = sbp ~ weight, data = filter(wcgs, arcus == 1))

Residuals:
    Min      1Q  Median      3Q     Max 
-30.335  -9.636  -1.961   7.973  76.738 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 101.87847    3.75572  27.126  &lt; 2e-16 ***
weight        0.16261    0.02201   7.388 3.29e-13 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.19 on 939 degrees of freedom
Multiple R-squared:  0.05494,   Adjusted R-squared:  0.05393 
F-statistic: 54.58 on 1 and 939 DF,  p-value: 3.29e-13</code></pre>
<p>The linear model for the 941 patients with Arcus Senilis has R-squared = 5.49%.</p>
<ul>
<li>The regression equation is 101.88 - 0.163 weight, for those patients with Arcus Senilis.</li>
</ul>
</div>
<div id="including-arcus-status-in-the-model" class="section level2" number="15.10">
<h2>
<span class="header-section-number">15.10</span> Including Arcus Status in the model<a class="anchor" aria-label="anchor" href="#including-arcus-status-in-the-model"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sbp</span> <span class="op">~</span> <span class="va">weight</span> <span class="op">*</span> <span class="va">arcus</span>, data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">arcus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">95.92</td>
<td align="right">2.52</td>
<td align="right">38.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0.19</td>
<td align="right">0.01</td>
<td align="right">12.92</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">arcus</td>
<td align="right">5.96</td>
<td align="right">4.62</td>
<td align="right">1.29</td>
<td align="right">0.20</td>
</tr>
<tr class="even">
<td align="left">weight:arcus</td>
<td align="right">-0.03</td>
<td align="right">0.03</td>
<td align="right">-1.02</td>
<td align="right">0.31</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">r.squared</span><span class="op">:</span><span class="va">p.value</span>, <span class="va">AIC</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">AIC</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.066</td>
<td align="right">0.065</td>
<td align="right">14.62</td>
<td align="right">74.094</td>
<td align="right">0</td>
<td align="right">25860.96</td>
</tr></tbody>
</table></div>
<div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = sbp ~ weight * arcus, data = filter(wcgs, !is.na(arcus)))

Residuals:
    Min      1Q  Median      3Q     Max 
-30.335 -10.152  -2.349   7.669  99.848 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  95.92190    2.52440  37.998   &lt;2e-16 ***
weight        0.19017    0.01472  12.921   &lt;2e-16 ***
arcus         5.95657    4.61972   1.289    0.197    
weight:arcus -0.02756    0.02703  -1.019    0.308    
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.62 on 3148 degrees of freedom
Multiple R-squared:  0.06595,   Adjusted R-squared:  0.06506 
F-statistic: 74.09 on 3 and 3148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The actual regression equation in this setting includes both weight, and an indicator variable (1 = yes, 0 = no) for arcus senilis status, and the product term combining weight and that 1/0 indicator. In 432, we’ll spend substantial time and energy discussing these product terms, but we’ll not do much of that in 431.</p>
<ul>
<li>Note the use of the product term <code>weight*arcus</code> in the setup of the model to allow both the slope of weight and the intercept term in the model to change depending on arcus senilis status.
<ul>
<li>For a patient who has arcus, the regression equation is SBP = 95.92 + 0.19 weight + 5.96 (1) - 0.028 weight (1) = 101.88 + 0.162 weight.</li>
<li>For a patient without arcus senilis, the regression equation is SBP = 95.92 + 0.19 weight + 5.96 (0) - 0.028 weight (0) = 95.92 + 0.19 weight.</li>
</ul>
</li>
</ul>
<p>The linear model including the interaction of weight and arcus to predict sbp for the 3152 patients with known Arcus Senilis status has R-squared = 6.6%. Again, we’ll discuss interaction more substantially in 432.</p>
</div>
<div id="predictions-from-these-linear-models" class="section level2" number="15.11">
<h2>
<span class="header-section-number">15.11</span> Predictions from these Linear Models<a class="anchor" aria-label="anchor" href="#predictions-from-these-linear-models"><i class="fas fa-link"></i></a>
</h2>
<p>What is our predicted SBP for a subject weighing 175 pounds?</p>
<p>How does that change if our subject weighs 200 pounds?</p>
<p>Recall that</p>
<ul>
<li>
<em>Without</em> Arcus Senilis, linear model for SBP = 95.9 + 0.19 x weight</li>
<li>
<em>With</em> Arcus Senilis, linear model for SBP = 101.9 + 0.16 x weight</li>
</ul>
<p>So the predictions for a 175 pound subject are:</p>
<ul>
<li><p>95.9 + 0.19 x 175 = 129 mm Hg without Arcus Senilis, and</p></li>
<li><p>101.9 + 0.16 x 175 = 130 mm Hg with Arcus Senilis.</p></li>
</ul>
<p>And thus, the predictions for a 200 pound subject are:</p>
<ul>
<li><p>95.9 + 0.19 x 200 = 134 mm Hg without Arcus Senilis, and</p></li>
<li><p>101.9 + 0.16 x 200 = 134.4 mm Hg with Arcus Senilis.</p></li>
</ul>
</div>
<div id="scatterplots-with-facets-across-a-categorical-variable" class="section level2" number="15.12">
<h2>
<span class="header-section-number">15.12</span> Scatterplots with Facets Across a Categorical Variable<a class="anchor" aria-label="anchor" href="#scatterplots-with-facets-across-a-categorical-variable"><i class="fas fa-link"></i></a>
</h2>
<p>We can use facets in <code>ggplot2</code> to show scatterplots across the levels of a categorical variable, like <code>behpat</code>.</p>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wcgs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">sbp</span>, col <span class="op">=</span> <span class="va">behpat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">behpat</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, 
                formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"royalblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Scatterplots of SBP vs. Weight within Behavior Pattern"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk210-1.png" width="672"></div>
</div>
<div id="scatterplot-and-correlation-matrices" class="section level2" number="15.13">
<h2>
<span class="header-section-number">15.13</span> Scatterplot and Correlation Matrices<a class="anchor" aria-label="anchor" href="#scatterplot-and-correlation-matrices"><i class="fas fa-link"></i></a>
</h2>
<p>A <strong>scatterplot matrix</strong> can be very helpful in understanding relationships between multiple variables simultaneously. There are several ways to build such a thing, including the <code>pairs</code> function…</p>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span> <span class="op">(</span><span class="op">~</span> <span class="va">sbp</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">height</span>, data<span class="op">=</span><span class="va">wcgs</span>, main<span class="op">=</span><span class="st">"Simple Scatterplot Matrix"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk220-1.png" width="672"></div>
<div id="displaying-a-correlation-matrix" class="section level3" number="15.13.1">
<h3>
<span class="header-section-number">15.13.1</span> Displaying a Correlation Matrix<a class="anchor" aria-label="anchor" href="#displaying-a-correlation-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb566"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wcgs</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sbp</span>, <span class="va">age</span>, <span class="va">weight</span>, <span class="va">height</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">cor</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># obtain correlation coefficients for this subgroup</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># round them off to three significant figures before printing</span></code></pre></div>
<pre><code>          sbp     age  weight  height
sbp    1.0000  0.1660  0.2530  0.0184
age    0.1660  1.0000 -0.0344 -0.0954
weight 0.2530 -0.0344  1.0000  0.5330
height 0.0184 -0.0954  0.5330  1.0000</code></pre>
</div>
<div id="using-the-ggally-package" class="section level3" number="15.13.2">
<h3>
<span class="header-section-number">15.13.2</span> Using the <code>GGally</code> package<a class="anchor" aria-label="anchor" href="#using-the-ggally-package"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>ggplot2</code> system doesn’t have a built-in scatterplot system. There are some nice add-ins in the world, though. One option I sort of like is in the <code>GGally</code> package, which can produce both correlation matrices and scatterplot matrices.</p>
<p>The <code>ggpairs</code> function provides a density plot on each diagonal, Pearson correlations on the upper right and scatterplots on the lower left of the matrix.</p>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">wcgs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sbp</span>, <span class="va">age</span>, <span class="va">weight</span>, <span class="va">height</span><span class="op">)</span>, 
                title <span class="op">=</span> <span class="st">"Scatterplot Matrix via ggpairs"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="15_wcgs_files/figure-html/c15_chunk240-1.png" width="672"></div>

</div>
</div>
</div>




  <div class="chapter-nav">
<div class="prev"><a href="Hydrate-Study.html"><span class="header-section-number">14</span> Dehydration Recovery</a></div>
<div class="next"><a href="confidence-intervals-for-a-mean.html"><span class="header-section-number">16</span> Confidence Intervals for a Mean</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#WCGS-Study"><span class="header-section-number">15</span> The WCGS</a></li>
<li>
<a class="nav-link" href="#the-western-collaborative-group-study-wcgs-data-set"><span class="header-section-number">15.1</span> The Western Collaborative Group Study (wcgs) data set</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#structure-of-wcgs"><span class="header-section-number">15.1.1</span> Structure of wcgs</a></li>
<li><a class="nav-link" href="#codebook-for-wcgs"><span class="header-section-number">15.1.2</span> Codebook for wcgs</a></li>
<li><a class="nav-link" href="#quick-summary"><span class="header-section-number">15.1.3</span> Quick Summary</a></li>
</ul>
</li>
<li><a class="nav-link" href="#are-the-sbps-normally-distributed"><span class="header-section-number">15.2</span> Are the SBPs Normally Distributed?</a></li>
<li><a class="nav-link" href="#identifying-and-describing-sbp-outliers"><span class="header-section-number">15.3</span> Identifying and Describing SBP outliers</a></li>
<li><a class="nav-link" href="#does-weight-category-relate-to-sbp"><span class="header-section-number">15.4</span> Does Weight Category Relate to SBP?</a></li>
<li>
<a class="nav-link" href="#re-leveling-a-factor"><span class="header-section-number">15.5</span> Re-Leveling a Factor</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#sbp-by-weight-category"><span class="header-section-number">15.5.1</span> SBP by Weight Category</a></li></ul>
</li>
<li><a class="nav-link" href="#are-weight-and-sbp-linked"><span class="header-section-number">15.6</span> Are Weight and SBP Linked?</a></li>
<li><a class="nav-link" href="#sbp-and-weight-by-arcus-senilis-groups"><span class="header-section-number">15.7</span> SBP and Weight by Arcus Senilis groups?</a></li>
<li><a class="nav-link" href="#linear-model-for-sbp-weight-relationship-subjects-without-arcus-senilis"><span class="header-section-number">15.8</span> Linear Model for SBP-Weight Relationship: subjects without Arcus Senilis</a></li>
<li><a class="nav-link" href="#linear-model-for-sbp-weight-relationship-subjects-with-arcus-senilis"><span class="header-section-number">15.9</span> Linear Model for SBP-Weight Relationship: subjects with Arcus Senilis</a></li>
<li><a class="nav-link" href="#including-arcus-status-in-the-model"><span class="header-section-number">15.10</span> Including Arcus Status in the model</a></li>
<li><a class="nav-link" href="#predictions-from-these-linear-models"><span class="header-section-number">15.11</span> Predictions from these Linear Models</a></li>
<li><a class="nav-link" href="#scatterplots-with-facets-across-a-categorical-variable"><span class="header-section-number">15.12</span> Scatterplots with Facets Across a Categorical Variable</a></li>
<li>
<a class="nav-link" href="#scatterplot-and-correlation-matrices"><span class="header-section-number">15.13</span> Scatterplot and Correlation Matrices</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#displaying-a-correlation-matrix"><span class="header-section-number">15.13.1</span> Displaying a Correlation Matrix</a></li>
<li><a class="nav-link" href="#using-the-ggally-package"><span class="header-section-number">15.13.2</span> Using the GGally package</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/THOMASELOVE/431-notes/blob/master/15_wcgs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/THOMASELOVE/431-notes/edit/master/15_wcgs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science for Biological, Medical and Health Research: Notes for PQHS/CRSP/MPHP 431</strong>" was written by Thomas E. Love. It was last built on 2021-10-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
